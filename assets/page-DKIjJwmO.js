import{j as e}from"./mui-8bJoa1Af.js";import{T as l,C as _,c as R,x as z,y as le,R as ie,z as de,A as ue,D as G,P as W,E as y,G as K,H as Z,J as pe,K as fe,N as xe,O as me,Q as he,S as ve,V as ge,W as je,X as Ne,Y as q,B as S,Z as Pe,a as $,$ as be,d as Ce,a0 as Ee,a1 as we,p as Ie,b as k,a2 as Oe,a3 as Se,a4 as Re}from"./index-DCfRxWnN.js";import{S as F}from"./filter-B8x8g7tl.js";import{r as m,d as Ae}from"./vendor-DljJgkTU.js";function _e({buyer:r,isPrinting:n}){return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(l,{variant:"uppercase",className:"font-bold",children:"buyer information:"}),e.jsx(l,{className:"flex items-center gap-2",variant:"uppercase",children:["email: ",e.jsx(l,{component:"span",className:"lowercase select-all",children:e.jsx(_,{text:(r==null?void 0:r.email)||""})})]}),e.jsxs(l,{variant:"uppercase",children:["first name: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.firstName})]}),e.jsxs(l,{variant:"uppercase",children:["last name: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.lastName})]}),e.jsxs(l,{variant:"uppercase",children:["phone: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.phone})]}),e.jsx(l,{variant:"uppercase",className:R({hidden:n}),children:["receive promo emails: ",r!=null&&r.receivePromoEmails?e.jsx(l,{component:"span",className:F.confirmed,children:"yes"}):e.jsx(l,{component:"span",className:F.denied,children:"no"})]})]})}var U="Popover",[V]=de(U,[z]),M=z(),[Te,A]=V(U),J=r=>{const{__scopePopover:n,children:s,open:t,defaultOpen:a,onOpenChange:o,modal:d=!1}=r,i=M(n),x=m.useRef(null),[v,g]=m.useState(!1),[c,u]=le({prop:t,defaultProp:a??!1,onChange:o,caller:U});return e.jsx(ie,{...i,children:e.jsx(Te,{scope:n,contentId:ue(),triggerRef:x,open:c,onOpenChange:u,onOpenToggle:m.useCallback(()=>u(f=>!f),[u]),hasCustomAnchor:v,onCustomAnchorAdd:m.useCallback(()=>g(!0),[]),onCustomAnchorRemove:m.useCallback(()=>g(!1),[]),modal:d,children:s})})};J.displayName=U;var Q="PopoverAnchor",ye=m.forwardRef((r,n)=>{const{__scopePopover:s,...t}=r,a=A(Q,s),o=M(s),{onCustomAnchorAdd:d,onCustomAnchorRemove:i}=a;return m.useEffect(()=>(d(),()=>i()),[d,i]),e.jsx(K,{...o,...t,ref:n})});ye.displayName=Q;var X="PopoverTrigger",D=m.forwardRef((r,n)=>{const{__scopePopover:s,...t}=r,a=A(X,s),o=M(s),d=G(n,a.triggerRef),i=e.jsx(W.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":ae(a.open),...t,ref:d,onClick:y(r.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:e.jsx(K,{asChild:!0,...o,children:i})});D.displayName=X;var H="PopoverPortal",[Me,ke]=V(H,{forceMount:void 0}),ee=r=>{const{__scopePopover:n,forceMount:s,children:t,container:a}=r,o=A(H,n);return e.jsx(Me,{scope:n,forceMount:s,children:e.jsx(Z,{present:s||o.open,children:e.jsx(pe,{asChild:!0,container:a,children:t})})})};ee.displayName=H;var T="PopoverContent",re=m.forwardRef((r,n)=>{const s=ke(T,r.__scopePopover),{forceMount:t=s.forceMount,...a}=r,o=A(T,r.__scopePopover);return e.jsx(Z,{present:t||o.open,children:o.modal?e.jsx(Ue,{...a,ref:n}):e.jsx(Le,{...a,ref:n})})});re.displayName=T;var Fe=me("PopoverContent.RemoveScroll"),Ue=m.forwardRef((r,n)=>{const s=A(T,r.__scopePopover),t=m.useRef(null),a=G(n,t),o=m.useRef(!1);return m.useEffect(()=>{const d=t.current;if(d)return fe(d)},[]),e.jsx(xe,{as:Fe,allowPinchZoom:!0,children:e.jsx(se,{...r,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:y(r.onCloseAutoFocus,d=>{var i;d.preventDefault(),o.current||(i=s.triggerRef.current)==null||i.focus()}),onPointerDownOutside:y(r.onPointerDownOutside,d=>{const i=d.detail.originalEvent,x=i.button===0&&i.ctrlKey===!0,v=i.button===2||x;o.current=v},{checkForDefaultPrevented:!1}),onFocusOutside:y(r.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),Le=m.forwardRef((r,n)=>{const s=A(T,r.__scopePopover),t=m.useRef(!1),a=m.useRef(!1);return e.jsx(se,{...r,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var d,i;(d=r.onCloseAutoFocus)==null||d.call(r,o),o.defaultPrevented||(t.current||(i=s.triggerRef.current)==null||i.focus(),o.preventDefault()),t.current=!1,a.current=!1},onInteractOutside:o=>{var x,v;(x=r.onInteractOutside)==null||x.call(r,o),o.defaultPrevented||(t.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=o.target;((v=s.triggerRef.current)==null?void 0:v.contains(d))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),se=m.forwardRef((r,n)=>{const{__scopePopover:s,trapFocus:t,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:d,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:v,onInteractOutside:g,...c}=r,u=A(T,s),f=M(s);return he(),e.jsx(ve,{asChild:!0,loop:!0,trapped:t,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(ge,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:g,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:v,onDismiss:()=>u.onOpenChange(!1),children:e.jsx(je,{"data-state":ae(u.open),role:"dialog",id:u.contentId,...f,...c,ref:n,style:{...c.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ne="PopoverClose",te=m.forwardRef((r,n)=>{const{__scopePopover:s,...t}=r,a=A(ne,s);return e.jsx(W.button,{type:"button",...t,ref:n,onClick:y(r.onClick,()=>a.onOpenChange(!1))})});te.displayName=ne;var $e="PopoverArrow",He=m.forwardRef((r,n)=>{const{__scopePopover:s,...t}=r,a=M(s);return e.jsx(Ne,{...a,...t,ref:n})});He.displayName=$e;function ae(r){return r?"open":"closed"}var Be=J,Ye=D,ze=ee,Ge=re,We=te;function Ke({openElement:r,title:n,children:s,contentProps:t,className:a,gap:o="default",variant:d="default"}){const[i,x]=m.useState(!1);return e.jsxs(Be,{open:i,onOpenChange:x,children:[e.jsx(Ye,{className:"flex items-center",children:typeof r=="function"?r(i):r}),e.jsx(Ze,{className:a,title:n,gap:o,variant:d,...t,children:s})]})}function Ze({children:r,title:n,className:s,gap:t="default",variant:a="default",...o}){return e.jsx(ze,{children:e.jsxs(Ge,{side:"bottom",align:"center",className:R("relative z-20 w-full space-y-10 border border-textInactiveColor bg-bgColor px-2.5",{"space-y-16":t==="large","border-none":a==="no-borders"},s),...o,children:[n&&e.jsx(We,{className:R("fixed left-2 right-2 top-2.5 bg-bgColor","appearance-none border-0 outline-none focus:outline-none"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{variant:"uppercase",children:n}),e.jsx(l,{children:"[x]"})]})}),e.jsx("div",{className:"relative max-h-[50vh] overflow-y-scroll",children:e.jsx("div",{className:"sticky top-0",children:r})})]})})}function qe({orderDetails:r}){var n;return e.jsx(Ke,{variant:"default",contentProps:{align:"start",sideOffset:10},className:"p-5 bg-bgColor text-textColor",openElement:()=>e.jsx(S,{className:"border border-textInactiveColor rounded px-1 cursor-pointer",children:"i"}),children:e.jsx("div",{className:"flex flex-col gap-y-2",children:(n=r==null?void 0:r.statusHistory)==null?void 0:n.map(s=>{var t,a;return e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsxs(l,{children:[(a=(t=s.status)==null?void 0:t.replace("ORDER_STATUS_ENUM_",""))==null?void 0:a.replace("_"," "),": "]}),e.jsx(l,{children:q(s.changedAt,!0)})]},s.id)})})})}function Ve({orderDetails:r,orderStatus:n,isPrinting:s}){var o,d,i;const t=Pe(n),a=q((o=r==null?void 0:r.order)==null?void 0:o.placed,!0);return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[e.jsx(l,{variant:"uppercase",className:R("block",{"print:hidden":s}),children:`order id: ${(d=r==null?void 0:r.order)==null?void 0:d.id}`}),e.jsxs(l,{variant:"uppercase",className:"flex items-center gap-2",children:["order reference: ",e.jsx(_,{text:((i=r==null?void 0:r.order)==null?void 0:i.uuid)||""})]}),e.jsxs("div",{className:"flex items-center gap-2 print:hidden",children:[e.jsx(l,{variant:"uppercase",children:"status:"}),e.jsx(l,{variant:"uppercase",className:R(t),children:n}),e.jsx(qe,{orderDetails:r})]}),e.jsx(l,{variant:"uppercase",children:`placed: ${a}`})]})}const L="hidden lg:table-cell";function Je({orderDetails:r,isPrinting:n=!1,showRefundSelection:s=!1,selectedProductIds:t=[],onToggleOrderItems:a}){var x,v,g;const{dictionary:o}=$(),d=m.useMemo(()=>[{label:"THUMBNAIL",showOnPrint:!0,accessor:c=>{var u;return e.jsx("a",{href:`${be}/products/${(u=c.orderItem)==null?void 0:u.productId}`,target:"_blank",rel:"noopener noreferrer",className:"cursor-pointer flex items-center justify-center w-24 h-full mx-auto",children:e.jsx(Ce,{src:c.thumbnail||"",alt:"thumbnail",aspectRatio:"1/1",fit:"contain"})})}},{label:"SKU",showOnPrint:!0,className:L,accessor:c=>c.sku},{label:"PRODUCT NAME",showOnPrint:!0,accessor:c=>{var u;return(u=c.translations)==null?void 0:u[0].name}},{label:"SIZE",showOnPrint:!1,accessor:c=>{var u,f,j;return(j=(f=(u=o==null?void 0:o.sizes)==null?void 0:u.find(E=>{var C;return E.id===((C=c.orderItem)==null?void 0:C.sizeId)}))==null?void 0:f.name)==null?void 0:j.replace("SIZE_ENUM_","")}},{label:"PRICE",showOnPrint:!1,className:L,accessor:c=>{var u,f;return`${c.aggregatedBasePrice??(c.productPrice&&((u=c.orderItem)!=null&&u.quantity)?c.productPrice*c.orderItem.quantity:0)} ${((f=r==null?void 0:r.order)==null?void 0:f.currency)||""}`}},{label:"SALE",showOnPrint:!1,className:L,accessor:c=>c.productSalePercentage},{label:"PRICE WITH SALE",showOnPrint:!0,accessor:c=>{var u;return`${c.aggregatedPriceWithSale??c.productPriceWithSale} ${((u=r==null?void 0:r.order)==null?void 0:u.currency)||""}`}},{label:"REFUNDED",showOnPrint:!0,accessor:c=>{var u;return(u=r==null?void 0:r.refundedOrderItems)!=null&&u.some(f=>f.id===c.id)?"Yes":"No"}}],[o,(x=r==null?void 0:r.order)==null?void 0:x.currency,r==null?void 0:r.refundedOrderItems]),i=m.useMemo(()=>n?d.filter(c=>c.showOnPrint):d,[d,n]);return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-textColor min-w-max",children:[e.jsx("thead",{className:"bg-textInactiveColor h-10",children:e.jsxs("tr",{className:"border-b border-textColor",children:[s&&!n&&e.jsx("th",{className:"text-center w-10 border border-r border-textColor px-2",children:e.jsx(l,{variant:"uppercase",className:"leading-none",children:"refund"})}),i.map(c=>e.jsx("th",{className:`text-center w-auto lg:min-w-26 border border-r border-textColor px-2 ${c.className||""}`,children:e.jsx(l,{variant:"uppercase",className:"leading-none",children:c.label})},c.label))]})}),e.jsx("tbody",{children:((v=r==null?void 0:r.orderItems)==null?void 0:v.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:i.length,className:"text-center py-8",children:e.jsx(l,{variant:"uppercase",children:"no items found"})})}):(g=r==null?void 0:r.orderItems)==null?void 0:g.map((c,u)=>{var I;const f=typeof c.id=="number"?c.id:null,j=f!=null?[f]:[],E=f!=null&&((I=r==null?void 0:r.refundedOrderItems)==null?void 0:I.some(N=>N.id===f)),C=j.length>0&&j.every(N=>t.includes(N)),O=()=>{!j.length||!a||a(j)};return e.jsxs("tr",{className:"border-b border-text last:border-b-0 lg:w-24",children:[s&&!n&&e.jsx("td",{className:"border border-textColor text-center px-2 w-10",children:e.jsx("input",{type:"checkbox",checked:C,onChange:O,className:"cursor-pointer"})}),i.map(N=>{var h;const p=N.label!=="THUMBNAIL"&&N.label!=="REFUNDED";return e.jsx("td",{className:R("border border-textColor text-center px-2 w-16 lg:w-auto",N.className,E&&p&&'relative after:content-[""] after:absolute after:left-0 after:right-0 after:top-1/2 after:h-px after:bg-current',{"bg-textInactiveColor/80":(h=r.refundedOrderItems)==null?void 0:h.some(P=>P.id===f)}),children:N.label==="THUMBNAIL"?N.accessor(c):e.jsx(l,{children:N.accessor(c)})},N.label)})]},f??u)})})]})})})}function Qe({orderDetails:r,isPrinting:n}){var t,a,o,d,i,x,v,g,c,u,f,j,E,C,O,I,N,p;const s=r==null?void 0:r.payment;return e.jsxs("div",{className:R("flex flex-col gap-1",{hidden:n}),children:[e.jsx(l,{variant:"uppercase",className:"font-bold",children:"payment:"}),e.jsxs(l,{variant:"uppercase",children:["status:"," ",(t=s==null?void 0:s.paymentInsert)!=null&&t.isTransactionDone?e.jsx(l,{component:"span",className:F.confirmed,children:"paid"}):e.jsx(l,{component:"span",className:F.denied,children:"unpaid"})]}),e.jsxs(l,{variant:"uppercase",children:["made at: ",Ee(s==null?void 0:s.modifiedAt)]}),e.jsxs(l,{variant:"uppercase",children:["payment method:"," ",(o=(a=s==null?void 0:s.paymentInsert)==null?void 0:a.paymentMethod)==null?void 0:o.replace("PAYMENT_METHOD_NAME_ENUM_","")]}),e.jsx(l,{variant:"uppercase",children:["amount: ",((d=s==null?void 0:s.paymentInsert)==null?void 0:d.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD"||((i=s==null?void 0:s.paymentInsert)==null?void 0:i.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD_TEST"?e.jsx("span",{children:(v=(x=s==null?void 0:s.paymentInsert)==null?void 0:x.transactionAmountPaymentCurrency)==null?void 0:v.value}):e.jsx("span",{children:(c=(g=s==null?void 0:s.paymentInsert)==null?void 0:g.transactionAmount)==null?void 0:c.value})]}),((u=s==null?void 0:s.paymentInsert)==null?void 0:u.payer)&&e.jsx(l,{variant:"uppercase",className:"flex items-center gap-2",children:["payer: ",e.jsx(_,{text:((f=s==null?void 0:s.paymentInsert)==null?void 0:f.payer)||""})]}),((j=s==null?void 0:s.paymentInsert)==null?void 0:j.payee)&&e.jsx(l,{variant:"uppercase",className:"flex items-center gap-2",children:["payee: ",e.jsx(_,{text:((E=s==null?void 0:s.paymentInsert)==null?void 0:E.payee)||""})]}),((C=s==null?void 0:s.paymentInsert)==null?void 0:C.isTransactionDone)&&e.jsx(l,{variant:"uppercase",className:"flex items-center gap-2",children:((O=s.paymentInsert)==null?void 0:O.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD_TEST"||((I=s.paymentInsert)==null?void 0:I.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD"?["client secret: ",e.jsx(_,{text:((N=s==null?void 0:s.paymentInsert)==null?void 0:N.clientSecret)||"",cutText:!0})]:["txid: ",e.jsx(_,{text:((p=s==null?void 0:s.paymentInsert)==null?void 0:p.transactionId)||"",cutText:!0})]})]})}function Xe({orderDetails:r}){var s,t;const n=(s=r==null?void 0:r.promoCode)==null?void 0:s.promoCodeInsert;return n&&e.jsxs("div",{className:"flex flex-row lg:flex-col gap-2",children:[e.jsx(l,{variant:"uppercase",children:`promo applied: ${n.code} - ${(t=n.discount)==null?void 0:t.value}%`}),n.freeShipping&&e.jsx(l,{variant:"uppercase",children:"free ship"}),n.voucher&&e.jsx(l,{variant:"uppercase",children:"voucher"})]})}function B({shipping:r}){return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs(l,{variant:"uppercase",children:["street adress: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.addressLineOne})]}),e.jsxs(l,{variant:"uppercase",children:["city: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.city})]}),(r==null?void 0:r.state)&&e.jsxs(l,{variant:"uppercase",children:["state: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.state})]}),e.jsxs(l,{variant:"uppercase",children:["country: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.country})]}),e.jsxs(l,{variant:"uppercase",children:["postal code: ",e.jsx("span",{className:"select-all",children:r==null?void 0:r.postalCode})]})]})}function oe({trackingNumber:r,isPrinting:n,handleTrackingNumberChange:s,saveTrackingNumber:t}){return e.jsx("div",{className:R("w-full border border-textColor",{hidden:n}),children:e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(we,{name:"trackingNumber",placeholder:"tracking number",className:"placeholder:uppercase border border-b border-transparent h-9",value:r,onChange:s}),e.jsx(S,{onClick:t,variant:"main",size:"lg",children:"+"})]})})}function De({isEdit:r,isPrinting:n,trackingNumber:s,orderStatus:t,orderDetails:a,toggleTrackNumber:o,handleTrackingNumberChange:d,saveTrackingNumber:i}){var x,v;return e.jsx(e.Fragment,{children:((x=a==null?void 0:a.shipment)==null?void 0:x.trackingCode)&&e.jsx("div",{className:"w-full",children:r&&!n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{isPrinting:n,trackingNumber:s,handleTrackingNumberChange:d,saveTrackingNumber:i}),e.jsx(S,{variant:"main",className:"cursor-pointer",size:"lg",onClick:o,children:"close"})]}):!n&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"uppercase",children:["tracking number: ",(v=a==null?void 0:a.shipment)==null?void 0:v.trackingCode]}),t==="SHIPPED"&&e.jsx(S,{variant:"main",className:"px-1 cursor-pointer",onClick:o,children:"edit"})]})})})}function er({orderDetails:r,isPrinting:n,orderStatus:s,isEdit:t,trackingNumber:a,toggleTrackNumber:o,handleTrackingNumberChange:d,saveTrackingNumber:i}){var f,j,E,C;const{dictionary:x}=$(),[v,g]=m.useState(!1),c=(f=r==null?void 0:r.shipping)==null?void 0:f.addressInsert,u=(j=r==null?void 0:r.billing)==null?void 0:j.addressInsert;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 mb-4 print:hidden",children:[e.jsx(S,{onClick:()=>g(!1),variant:v?"simpleReverse":"main",className:"p-1",children:"Shipping"}),e.jsx(S,{onClick:()=>g(!0),variant:v?"main":"simpleReverse",className:"p-1",children:"Billing"})]}),v?u&&e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsx(l,{variant:"uppercase",className:"font-bold",children:"billing address:"}),e.jsx(B,{shipping:u})]}):c&&e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsx(l,{variant:"uppercase",className:"font-bold",children:"shipping:"}),e.jsx(B,{shipping:c}),e.jsx(l,{variant:"uppercase",children:`cost: ${(C=(E=r==null?void 0:r.shipment)==null?void 0:E.cost)==null?void 0:C.value} ${x==null?void 0:x.baseCurrency}`}),e.jsx("div",{className:"w-full",children:e.jsx(De,{isEdit:t,isPrinting:n,trackingNumber:a,orderStatus:s||"",orderDetails:r,toggleTrackNumber:o,handleTrackingNumberChange:d,saveTrackingNumber:i})})]})]})}const rr=r=>{const{dictionary:n}=$(),s=Ie(p=>p.showMessage),[t,a]=m.useState({orderDetails:void 0,dictionary:void 0,orderStatus:void 0,isLoading:!1}),[o,d]=m.useState(!1),[i,x]=m.useState(!1),[v,g]=m.useState(""),[c,u]=m.useState([]);async function f(){a(p=>({...p,isLoading:!0}));try{const p=await k.GetOrderByUUID({orderUuid:r});a(h=>{var P,b;return{...h,orderDetails:p.order,dictionary:n,orderStatus:Oe(n,(b=(P=p.order)==null?void 0:P.order)==null?void 0:b.orderStatusId)}})}catch(p){const h=p instanceof Error?p.message:"Error fetching order details";s(h,"error")}finally{a(p=>({...p,isLoading:!1}))}}m.useEffect(()=>{f()},[r,n]),m.useEffect(()=>{const p=()=>d(!0),h=()=>d(!1);return window.addEventListener("beforeprint",p),window.addEventListener("afterprint",h),()=>{window.removeEventListener("beforeprint",p),window.removeEventListener("afterprint",h)}},[]);const j=()=>{var p,h;!o&&t.orderStatus==="SHIPPED"&&(x(!i),i&&g(((h=(p=t.orderDetails)==null?void 0:p.shipment)==null?void 0:h.trackingCode)||""))};function E(p){g(p.target.value)}const C=async()=>{var p,h;if(!v.trim()){x(!1);return}try{await k.SetTrackingNumber({orderUuid:(h=(p=t.orderDetails)==null?void 0:p.order)==null?void 0:h.uuid,trackingCode:v}),f(),x(!1)}catch(P){const b=P instanceof Error?P.message:"Failed to save tracking number";s(b,"error")}};async function O(){var h,P;if(window.confirm("Are you sure you want to mark this order as delivered?"))try{await k.DeliveredOrder({orderUuid:(P=(h=t.orderDetails)==null?void 0:h.order)==null?void 0:P.uuid}),f(),s("Order marked as delivered successfully","success")}catch(b){const w=b instanceof Error?b.message:"Failed to mark as delivered";s(w,"error")}}async function I(){var h,P;if(window.confirm("Are you sure you want to full refund this order?"))try{await k.RefundOrder({orderUuid:(P=(h=t.orderDetails)==null?void 0:h.order)==null?void 0:P.uuid,orderItemIds:c.length?c:[]}),f(),u([]),s("Order refunded successfully","success")}catch(b){const w=b instanceof Error?b.message:"Failed to refund order";s(w,"error")}}return{...t,isPrinting:o,isEdit:i,trackingNumber:v,selectedProductIds:c,saveTrackingNumber:C,toggleTrackNumber:j,handleTrackingNumberChange:E,markAsDelivered:O,refundOrder:I,toggleOrderItemsSelection:p=>{p.length&&u(h=>{if(p.every(w=>h.includes(w)))return h.filter(w=>!p.includes(w));const b=[...h];return p.forEach(w=>{b.includes(w)||b.push(w)}),b})}}},Y=["CONFIRMED","DELIVERED","PENDING RETURN","REFUND IN PROGRESS"];function or(){var f,j,E,C,O,I,N,p,h,P,b;const{uuid:r}=Ae(),{orderDetails:n,orderStatus:s,isPrinting:t,isEdit:a,trackingNumber:o,toggleTrackNumber:d,handleTrackingNumberChange:i,saveTrackingNumber:x,markAsDelivered:v,refundOrder:g,selectedProductIds:c,toggleOrderItemsSelection:u}=rr(r||"");return e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[t&&e.jsx("div",{className:"self-start h-10 pt-2",children:e.jsx(Se,{})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(Ve,{orderDetails:n,orderStatus:s,isPrinting:!0}),e.jsx(Je,{orderDetails:n,isPrinting:t,showRefundSelection:Y.includes(s||"")&&!["CONFIRMED"].includes(s||""),selectedProductIds:c,onToggleOrderItems:u}),e.jsx(l,{variant:"uppercase",className:"font-bold self-end",children:`Total: ${(j=(f=n==null?void 0:n.order)==null?void 0:f.totalPrice)==null?void 0:j.value} ${(E=n==null?void 0:n.order)==null?void 0:E.currency}`}),(s==="PARTIALLY REFUNDED"||s==="REFUNDED")&&e.jsx(l,{variant:"uppercase",className:"font-bold self-end",children:`refunded amount: ${(O=(C=n==null?void 0:n.order)==null?void 0:C.refundedAmount)==null?void 0:O.value} ${(I=n==null?void 0:n.order)==null?void 0:I.currency}`}),e.jsxs(l,{variant:"uppercase",className:"font-bold self-end",children:["cost: ",(p=(N=n==null?void 0:n.shipment)==null?void 0:N.cost)==null?void 0:p.value," ",(h=n==null?void 0:n.order)==null?void 0:h.currency]}),e.jsx("div",{className:"block self-end print:hidden",children:e.jsx(Xe,{orderDetails:n})}),e.jsxs("div",{className:"flex gap-10 lg:gap-0 lg:flex-row flex-col lg:items-end lg:justify-between w-full",children:[e.jsx(Qe,{orderDetails:n,isPrinting:t}),e.jsx(er,{orderDetails:n,isPrinting:t,orderStatus:s,isEdit:a,trackingNumber:o,toggleTrackNumber:d,handleTrackingNumberChange:i,saveTrackingNumber:x}),e.jsx(_e,{buyer:(P=n==null?void 0:n.buyer)==null?void 0:P.buyerInsert,isPrinting:t})]})]}),s==="REFUNDED"&&e.jsxs("div",{className:"flex flex-col gap-2 w-full lg:w-2/5",children:[e.jsx(l,{variant:"uppercase",className:"font-bold",children:"refund reason:"}),e.jsx("div",{className:"flex flex-wrap gap-3 w-full lg:w-4/5",children:Re.map((w,ce)=>e.jsx(S,{type:"button",size:"lg",className:"border border-textColor uppercase",children:w},ce))})]}),s==="CONFIRMED"&&!((b=n==null?void 0:n.shipment)!=null&&b.trackingCode)&&e.jsx("div",{className:"w-full lg:w-1/4",children:e.jsx(oe,{isPrinting:t,trackingNumber:o,handleTrackingNumberChange:i,saveTrackingNumber:x})}),s==="SHIPPED"&&e.jsx("div",{className:"fixed right-2.5 lg:absolute bottom-2.5 lg:left-1/2 lg:-translate-x-1/2 flex justify-center print:hidden",children:e.jsx(S,{variant:"main",size:"lg",onClick:v,children:"mark as delivered"})}),Y.includes(s||"")&&e.jsx("div",{className:"fixed right-2.5 lg:absolute bottom-2.5 lg:left-1/2 lg:-translate-x-1/2 flex justify-center print:hidden",children:e.jsx(S,{variant:"main",size:"lg",onClick:g,children:"refund order"})}),e.jsx(l,{variant:"uppercase",className:"font-bold hidden print:block",children:"If you have any questions, please send an email to customercare@grbpwr.com"})]})}export{or as OrderDetails};
