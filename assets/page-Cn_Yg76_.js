import{j as e}from"./mui-DmsMUjzh.js";import{u as T,r as n}from"./vendor-DljJgkTU.js";import{a as I,K as w,x as _,c as j,B as y,T as h,J as R,V as A,y as F,W as k,X as P,b as L}from"./index-DmkRfewp.js";import{s as N}from"./filter-B8x8g7tl.js";function M({orders:a,orderFactor:d,status:l,orderId:b,isLoading:s,onToggleSort:i,onStatusChange:c,onOrderIdChange:p}){var g;const{dictionary:f}=I(),v=T(),O=r=>{v(`${k.orders}/${r.uuid}`)},C=l?(g=N.find(r=>r.value===l))==null?void 0:g.label:null,u=n.useMemo(()=>[{label:"Order ID",accessor:r=>r.id},{label:"Order Status",accessor:r=>C??w(f,r.orderStatusId)},{label:"Placed",accessor:r=>_(r.placed)},{label:"Total",accessor:r=>{var t;return`${(t=r.totalPrice)==null?void 0:t.value} ${r.currency}`}}],[f,C]);return e.jsx("div",{className:"w-full flex flex-col gap-4",children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-textColor min-w-max",children:[e.jsx("thead",{className:"bg-textInactiveColor h-10 overflow-x-scroll",children:e.jsx("tr",{className:"border-b border-textColor",children:u.map(r=>e.jsx("th",{className:j("text-center h-10 min-w-26 border border-r border-textColor px-2",{"sticky left-0 bg-textInactiveColor z-10":r.label==="Order ID"}),children:r.label==="Order ID"?e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs(y,{onClick:i,disabled:s,className:"flex items-center justify-center gap-1 whitespace-nowrap hover:opacity-70 transition-opacity",children:[e.jsx("div",{className:"flex items-center gap-1 leading-none",children:["↑","↓"].map((t,x)=>e.jsx(h,{className:j("text-textColor",{"opacity-50":x===0&&d==="ORDER_FACTOR_DESC"||x===1&&d==="ORDER_FACTOR_ASC"}),children:t},t))}),e.jsx(h,{variant:"uppercase",children:r.label})]}),e.jsx(R,{name:"orderId",type:"number",placeholder:"order id",value:b,onChange:t=>p(t.target.value),disabled:s,className:"w-16 bg-textInactiveColor [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none placeholder:text-textColor"})]}):r.label==="Order Status"?e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(h,{className:"",variant:"uppercase",children:r.label}),e.jsx(A,{label:"",options:[{value:"all",label:"all"},...N],onChange:t=>c(t==="all"?"":t),value:l||"all",compact:!0,disabled:s})]}):e.jsx(h,{variant:"uppercase",children:r.label})},r.label))})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:u.length,className:"text-center py-8",children:e.jsx(h,{variant:"uppercase",children:"no orders found"})})}):a.map(r=>e.jsx("tr",{className:"group border-b border-text last:border-b-0 h-10 hover:bg-highlightColor/20 cursor-pointer transition-colors",onClick:()=>O(r),children:u.map(t=>{const x=t.accessor(r),m=t.label==="Order Status"?F(String(x)):"";return e.jsx("td",{className:j("border border-r border-textColor text-center px-2",m,{"sticky left-0 bg-bgColor group-hover:bg-highlightColor/20 z-10":t.label==="Order ID",uppercase:t.label==="Order Status"}),children:e.jsx(h,{children:x})},t.label)})},r.id))})]})})})}const S={all:["order"],orders:a=>[...S.all,"orders",a],order:a=>[...S.orders(),a]};function $(a=50,d="ORDER_FACTOR_DESC",l,b,s){return P({queryKey:[...S.orders(d),l,b,s],queryFn:async({pageParam:i})=>{var p;const c=await L.ListOrders({limit:a,offset:i,orderFactor:d,status:b,paymentMethod:void 0,email:l,orderId:s?Number(s):void 0});return{orders:c.orders||[],nextOffset:((p=c.orders)==null?void 0:p.length)===a?i+a:void 0}},getNextPageParam:i=>i.nextOffset,initialPageParam:0,staleTime:300*1e3})}function U(){const[a,d]=n.useState("ORDER_FACTOR_DESC"),[l,b]=n.useState(""),[s,i]=n.useState(""),[c,p]=n.useState(""),[f,v]=n.useState(""),[O,C]=n.useState("");n.useEffect(()=>{const o=setTimeout(()=>{v(c)},500);return()=>clearTimeout(o)},[c]),n.useEffect(()=>{const o=setTimeout(()=>{C(s)},500);return()=>clearTimeout(o)},[s]);const{data:u,isLoading:g,isError:r,fetchNextPage:t,hasNextPage:x,isFetchingNextPage:m}=$(50,a,f||void 0,l||void 0,O||void 0),E=(u==null?void 0:u.pages.flatMap(o=>o.orders))||[],D=()=>{d(o=>o==="ORDER_FACTOR_ASC"?"ORDER_FACTOR_DESC":"ORDER_FACTOR_ASC")};return e.jsxs("div",{className:"flex flex-col gap-4 pb-16",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(R,{name:"email",type:"text",placeholder:"enter email",value:c,onChange:o=>p(o.target.value),disabled:g||m,className:"w-64"})}),e.jsx(M,{orders:E,orderFactor:a,onToggleSort:D,status:l,onStatusChange:b,orderId:s,onOrderIdChange:i,isLoading:g||m}),x&&e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{variant:"main",size:"lg",onClick:()=>t(),disabled:m,children:m?"Loading...":"Load More"})})]})}export{U as OrdersCatalog};
