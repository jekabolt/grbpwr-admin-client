import{j as r}from"./mui-D9Bk7yoK.js";import{u as f,x as A,L as j,aa as S,T as $,E as D}from"./index-Dn3nVg0q.js";import{r as h}from"./vendor-DljJgkTU.js";function z({fieldPrefix:s,fields:l,editMode:y=!0}){const{control:C,watch:d,setValue:i,formState:{errors:b}}=f(),{replace:p}=A({control:C,name:s}),o=d(s)||[],[u,E]=h.useState(j[0].id),[v,w]=h.useState({}),I=j.find(n=>n.id===u),g=o.findIndex(n=>(n==null?void 0:n.languageId)===u),m=g>=0?g:o.length;h.useEffect(()=>{if(o.length===0){const n=j.map(a=>{const e={languageId:a.id};return l.forEach(t=>{e[t.name]=""}),e});p(n)}},[o.length,p]),h.useEffect(()=>{if(g<0&&o.length>0){const n={languageId:u};l.forEach(e=>{n[e.name]=""});const a=[...o,n];p(a)}else g>=0&&i(`${s}.${g}.languageId`,u,{shouldDirty:!0})},[u,g,o.length,p,i,s]),h.useEffect(()=>{var c;const n=s.split(".");let a=b;for(const x of n)if(a=a==null?void 0:a[x],!a)return;if(!Array.isArray(a)||!a.length||!o.length)return;const e=a.findIndex(x=>x&&l.some(V=>x[V.name])),t=(c=o[e])==null?void 0:c.languageId;e!==-1&&typeof t=="number"&&E(t)},[b,s,l,o]),h.useEffect(()=>{const n={};l.forEach(a=>{const e=`${s}.${m}.${a.name}`;n[a.name]=d(e)||""}),w(n)},[u,m,l,s,d]);const L=(n,a)=>{n.preventDefault(),l.forEach(e=>{const t=`${s}.${m}.${e.name}`,c=v[e.name];c!==void 0&&i(t,c,{shouldDirty:!0})}),E(a)},N=(n,a)=>{w(t=>({...t,[n]:a}));const e=`${s}.${m}.${n}`;i(e,a,{shouldDirty:!0})},F=n=>{const a=o.findIndex(e=>(e==null?void 0:e.languageId)===n);return a<0?!1:l.some(e=>{const t=d(`${s}.${a}.${e.name}`);return t&&t.trim().length>0})},T=n=>{const e=`${s}.${m}.${n}`.split(".");let t=b;for(const c of e){if(!t)return null;t=t[c]}return t==null?void 0:t.message};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(S,{selectedLanguageId:u,isLanguageFilled:F,onLanguageChange:L}),r.jsx("div",{className:"space-y-4",children:l.map(n=>{const a=v[n.name]||"",e=n.placeholder||`enter ${n.label.toLowerCase()} in ${I==null?void 0:I.name}`,t=T(n.name);return n.type==="textarea"?r.jsxs("div",{className:"space-y-2",children:[r.jsx($,{component:"label",children:n.label}),r.jsx("textarea",{value:a,onChange:c=>N(n.name,c.target.value),placeholder:e,className:`w-full border ${t?"border-red-500":"border-text"} leading-4 bg-transparent resize-none min-h-[100px] focus:outline-none p-2`,rows:n.rows||4,readOnly:!y}),t&&r.jsx($,{className:"text-red-500",children:t})]},n.name):r.jsxs("div",{className:"space-y-2",children:[r.jsx($,{component:"label",children:n.label}),r.jsx("div",{className:`border-b ${t?"border-red-500":"border-textColor"}`,children:r.jsx(D,{value:a,onChange:c=>N(n.name,c.target.value),placeholder:e,className:"w-full border-none leading-4 bg-transparent",readOnly:!y})}),t&&r.jsx($,{className:"text-red-500",children:t})]},n.name)})})]})}export{z as U};
