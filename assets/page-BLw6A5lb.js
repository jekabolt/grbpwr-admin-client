import{j as s}from"./mui-uYomrlsc.js";import{B as E,a as z,am as Fe,an as ie,ao as q,ap as W,a6 as $,T as b,c as G,a5 as ve,a1 as oe,a8 as ke,aq as ze,p as je,d as Me,ar as le,as as De,b as te,at as $e,au as Ae,av as Ue,aw as Be,ax as qe,ay as We,az as Ge,aA as ce}from"./index-UWfNKM0D.js";import{c as He,g as Ye,P as Ke,D as A}from"./filter-B8x8g7tl.js";import{g as Xe,L as Ze,k as F,j as Je,u as re,r as T}from"./vendor-DljJgkTU.js";import{b as Qe,r as es,d as ss,a as Ce}from"./isObjectLike-CYX_8sBO.js";import{S as be}from"./select-BN7fjqz-.js";import{C as H}from"./checkbox-Bn4WceUj.js";var Y,de;function ns(){if(de)return Y;de=1;var e=Qe(),n=function(){return e.Date.now()};return Y=n,Y}var K,ue;function ts(){if(ue)return K;ue=1;var e=/\s/;function n(r){for(var t=r.length;t--&&e.test(r.charAt(t)););return t}return K=n,K}var X,me;function rs(){if(me)return X;me=1;var e=ts(),n=/^\s+/;function r(t){return t&&t.slice(0,e(t)+1).replace(n,"")}return X=r,X}var Z,fe;function as(){if(fe)return Z;fe=1;var e=es(),n=ss(),r="[object Symbol]";function t(c){return typeof c=="symbol"||n(c)&&e(c)==r}return Z=t,Z}var J,he;function is(){if(he)return J;he=1;var e=rs(),n=Ce(),r=as(),t=NaN,c=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,h=parseInt;function i(o){if(typeof o=="number")return o;if(r(o))return t;if(n(o)){var d=typeof o.valueOf=="function"?o.valueOf():o;o=n(d)?d+"":d}if(typeof o!="string")return o===0?o:+o;o=e(o);var f=a.test(o);return f||l.test(o)?h(o.slice(2),f?2:8):c.test(o)?t:+o}return J=i,J}var Q,ge;function os(){if(ge)return Q;ge=1;var e=Ce(),n=ns(),r=is(),t="Expected a function",c=Math.max,a=Math.min;function l(h,i,o){var d,f,g,u,m,v,j=0,S=!1,N=!1,p=!0;if(typeof h!="function")throw new TypeError(t);i=r(i)||0,e(o)&&(S=!!o.leading,N="maxWait"in o,g=N?c(r(o.maxWait)||0,i):g,p="trailing"in o?!!o.trailing:p);function I(C){var V=d,M=f;return d=f=void 0,j=C,u=h.apply(M,V),u}function x(C){return j=C,m=setTimeout(R,i),S?I(C):u}function _(C){var V=C-v,M=C-j,ae=i-V;return N?a(ae,g-M):ae}function L(C){var V=C-v,M=C-j;return v===void 0||V>=i||V<0||N&&M>=g}function R(){var C=n();if(L(C))return O(C);m=setTimeout(R,_(C))}function O(C){return m=void 0,p&&d?I(C):(d=f=void 0,u)}function w(){m!==void 0&&clearTimeout(m),j=0,d=v=f=m=void 0}function k(){return m===void 0?u:O(n())}function P(){var C=n(),V=L(C);if(d=arguments,f=this,v=C,V){if(m===void 0)return x(v);if(N)return clearTimeout(m),m=setTimeout(R,i),I(v)}return m===void 0&&(m=setTimeout(R,i)),u}return P.cancel=w,P.flush=k,P}return Q=l,Q}var ls=os();const cs=Xe(ls),ds=e=>e.filter(r=>r.level==="top_category").map(r=>{var h;const t=e.filter(i=>i.level==="sub_category"&&i.parentId===r.id),a=((h=r.name)==null?void 0:h.toLowerCase())??"";if(t.length===0)return{id:r.id,name:a,href:`/catalog/${a.toLowerCase()}`,subCategories:[{id:r.id,name:a,href:`/catalog/${a.toLowerCase()}`}]};const l=t.map(i=>({id:i.id,name:i.name,href:`/catalog/${a.toLowerCase()}/${i.name.toLowerCase()}`}));return{id:r.id,name:a,href:`/catalog/${a.toLowerCase()}`,subCategories:l}});function ee(e,n){const r=e.find(c=>c.level==="top_category"&&c.id===n);if(!r||!r.name)return null;const t=r.name.toLowerCase();return t||r.name||null}function us(e,n){const r=e.find(t=>t.level==="sub_category"&&t.id===n);return!r||!r.name?null:r.name||null}function ms(e,n){const t=ds(e).find(c=>c.id===n);return(t==null?void 0:t.subCategories)||[]}function se({href:e,children:n,disabled:r=!1,variant:t="default"}){return s.jsx(E,{asChild:!r,variant:t,className:"whitespace-nowrap uppercase hover:underline",disabled:r,children:r?s.jsx(s.Fragment,{children:n}):s.jsx(Ze,{to:e,children:n})})}function U(){var f,g;const{dictionary:e}=z(),[n]=F(),r=n.get("topCategory"),t=n.get("subCategory"),c=n.get("gender")||"",a=Fe[c]??c,l=(e==null?void 0:e.categories)||[],h=r?l.find(u=>u.level==="top_category"&&String(u.id)===r)??null:null,i=t?l.find(u=>u.level==="sub_category"&&String(u.id)===t&&(h?u.parentId===h.id:!0))??null:null,o=h?((f=h.name)==null?void 0:f.toLowerCase())??"":"",d=i?((g=i.name)==null?void 0:g.toLowerCase())??"":"";return{gender:a||"",categoryName:o,subCategoryName:d,topCategory:h??void 0,subCategory:i??void 0}}function ne(e,n){const r=new URLSearchParams(e);n.topCategory!==void 0&&(n.topCategory?r.set("topCategory",n.topCategory):r.delete("topCategory")),n.subCategory!==void 0&&(n.subCategory?r.set("subCategory",n.subCategory):r.delete("subCategory")),n.gender!==void 0&&(n.gender?r.set("gender",n.gender):r.delete("gender"));const t=r.toString();return t?`${$.product}?${t}`:$.product}const pe="SORT_FACTOR_CREATED_AT",xe="ORDER_FACTOR_DESC";function fs(e){return e?q[e]?q[e]:e.startsWith("SORT_FACTOR_")&&e!=="SORT_FACTOR_UNKNOWN"?e:pe:pe}function hs(e){return e?W[e]?W[e]:e.startsWith("ORDER_FACTOR_")&&e!=="ORDER_FACTOR_UNKNOWN"?e:xe:xe}function gs(e){return!!(e&&e.startsWith("GENDER_ENUM_")&&e!=="GENDER_ENUM_UNKNOWN"&&e!=="all")}function Ne({sort:e,order:n,topCategory:r,subCategory:t,type:c,gender:a,sizes:l,tag:h,color:i,from:o,to:d,sale:f,preorder:g,hidden:u,collections:m,currency:v}){const j=fs(e),S=hs(n),N=a&&ie[a.toLowerCase()]?ie[a.toLowerCase()]:a;return{sortFactors:[j],orderFactor:S,filterConditions:{from:o||void 0,to:d||void 0,gender:gs(N)?[N]:void 0,color:i&&i!=="all"?i:void 0,topCategoryIds:r?r.split(",").map(p=>parseInt(p)):void 0,subCategoryIds:t?t.split(",").map(p=>parseInt(p)):void 0,typeIds:c?c.split(",").map(p=>parseInt(p)):void 0,sizesIds:l?l.split(",").map(p=>parseInt(p)):void 0,byTag:h||void 0,preorder:g?g==="true":void 0,onSale:f?f==="true":void 0,collections:m?m.split(","):void 0,currency:v||void 0},showHidden:u!=="false"}}function ps(){var l,h;const[e]=F(),{gender:n}=U(),r=e.get("gender")||void 0,{dictionary:t}=z(),c=(t==null?void 0:t.categories)||[],a=(h=(l=t==null?void 0:t.categories)==null?void 0:l.filter(i=>i.level==="top_category"&&i.name!=="objects"))==null?void 0:h.filter(i=>{if(n==="men"){const o=ee(c,i.id||0);return(o==null?void 0:o.toLowerCase())!=="dresses"}return!0}).sort((i,o)=>(i.id||0)-(o.id||0));return s.jsx("div",{className:"flex items-center gap-2",children:a==null?void 0:a.map((i,o)=>{var u;const d=ee(c,i.id||0),f=((u=i.name)==null?void 0:u.toLowerCase())||"";if(!d)return null;const g=ne(e,{topCategory:String(i.id),subCategory:"",gender:r});return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(se,{href:g,disabled:ye(i,n),children:f||""}),o<a.length-1&&s.jsx(b,{children:"/"})]},i.id)})})}function xs(e,n){return n==="men"?e.filter(r=>{var t;return!["swimwear_w","bralettes","heels"].includes(((t=r.name)==null?void 0:t.toLowerCase())??"")}):e.filter(r=>{var t;return((t=r.name)==null?void 0:t.toLowerCase())!=="swimwear_m"})}function ye(e,n){return e?n?n==="men"?!e.countMen:!e.countWomen:!e.countMen&&!e.countWomen:!0}function Se(){const{dictionary:e}=z(),[n]=F(),{gender:r,categoryName:t,subCategoryName:c,topCategory:a,subCategory:l}=U(),h=n.get("gender")||void 0,i=(e==null?void 0:e.categories)||[],o=ms(i,(a==null?void 0:a.id)||0),d=xs(o,r);if(!t&&!(a!=null&&a.id))return s.jsx(ps,{});const f=a?ee(i,a.id||0):t,g=(l==null?void 0:l.id)!=null,u=ne(n,{topCategory:g&&(a==null?void 0:a.id)!=null?String(a.id):"",subCategory:"",gender:h});return s.jsxs("div",{className:"flex items-center gap-2 overflow-x-scroll w-full",children:[s.jsx(se,{href:u,children:f||t||""}),!!d.length&&s.jsx(b,{children:"/"}),d.map((m,v)=>{var I;const j=i.find(x=>x.id===m.id),S=ye(j,r),N=us(i,m.id),p=ne(n,{topCategory:(a==null?void 0:a.id)!=null?String(a.id):"",subCategory:String(m.id),gender:h});return s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(se,{href:p,variant:c===((I=m.name)==null?void 0:I.toLowerCase())?"underline":"default",disabled:S,children:N||""}),v<d.length-1&&s.jsx(b,{children:"/"})]},m.id)})]})}function we({cover:e,color:n="dark",disablePointerEvents:r=!0,onClick:t}){return s.jsx("div",{className:G("inset-0 z-20 h-screen",{"pointer-events-none":r,"bg-overlay":n==="dark","bg-white/50":n==="light","bg-highlightColor mix-blend-screen":n==="highlight",fixed:e==="screen","absolute h-full":e==="container"}),onClick:t,"aria-hidden":"true"})}function y(e,n=!1){const[r]=F(),t=Je().pathname,c=re();function a(i,o){const d=new URLSearchParams(r);i?Array.isArray(i)?i.length>0?d.set(e,i.join(",")):d.delete(e):d.set(e,i):d.delete(e),o&&Object.entries(o).forEach(([f,g])=>{g?d.set(f,g):d.delete(f)}),c(`${t}?${d.toString()}`,{replace:!0})}const l=r.get(e);return{defaultValue:n?(l==null?void 0:l.split(","))||[]:l||"",handleFilterChange:a}}function Te(){const{defaultValue:e,handleFilterChange:n}=y("color"),r=He.map(t=>({value:t.name.toLowerCase(),label:t.name}));return s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{variant:"uppercase",children:"color"}),s.jsx(ve,{label:"color",options:r,value:e||"",onChange:t=>n(t),showAll:!0})]})}const vs=Object.entries(ke).map(([e,n])=>({value:e,label:`${e} ${n}`}));function Ie(){const{defaultValue:e,handleFilterChange:n}=y("from"),{defaultValue:r,handleFilterChange:t}=y("to"),{defaultValue:c,handleFilterChange:a}=y("currency");return s.jsxs("div",{className:"flex",children:[s.jsx(be,{name:"currency",placeholder:"currency",items:vs,value:c||"",onValueChange:l=>a(l)}),s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsx(oe,{type:"number",placeholder:"price from",name:"from",value:e||"",onChange:l=>n(l.target.value)}),s.jsx(oe,{type:"number",placeholder:"price to",name:"to",value:r||"",onChange:l=>t(l.target.value)})]})]})}function _e(){const{defaultValue:e,handleFilterChange:n}=y("gender");return s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{variant:"uppercase",children:"gender"}),s.jsx(ve,{label:"gender",value:e||"all",options:Ye,onChange:n,showAll:!0})]})}function Ee(){const{defaultValue:e,handleFilterChange:n}=y("preorder"),{defaultValue:r,handleFilterChange:t}=y("hidden"),{defaultValue:c,handleFilterChange:a}=y("sale");return s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"preorder",label:"preorder",checked:e==="true",onChange:l=>n(l.toString())}),s.jsx(b,{variant:"uppercase",children:"preorder"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"hidden",label:"hidden",checked:r!=="false",onChange:l=>t(l?"true":"false")}),s.jsx(b,{variant:"uppercase",children:"show hidden"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"sale",label:"sale",checked:c==="true",onChange:l=>a(l.toString())}),s.jsx(b,{variant:"uppercase",children:"sale"})]})]})}const js=Ke.map(e=>({value:String(e.value),label:e.label}));function Re(){const{defaultValue:e,handleFilterChange:n}=y("limit"),r=e||String(A);return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(b,{variant:"uppercase",className:"w-auto whitespace-nowrap",children:"show latest"}),s.jsx(be,{name:"limit",placeholder:"quantity",items:js,value:r,onValueChange:t=>n(t)})]})}function Cs(e){const n=e.match(/_(\d+)(?:ta|bo)_[mf]$/);return n?n[1]:e}function bs(e){return"id"in e?String(e.id):e.name||""}function D(e){var n;return((n=e.name)==null?void 0:n.toLowerCase())||""}const Ns={numeric:/^\d+(\.\d+)?$/,bottoms:/_\d+bo_[mf]$/,tailored:/_\d+ta_[mf]$/};function Pe({selectedValues:e,values:n,title:r,showSeparated:t=!1,gender:c,handleFilterChange:a}){const[l,h]=T.useState(null),i=(x,_)=>Ns[_].test(x),o=x=>!i(x,"numeric")&&!i(x,"bottoms")&&!i(x,"tailored"),d=n.filter(x=>o(D(x))),f=n.filter(x=>i(D(x),"numeric")),g=n.filter(x=>i(D(x),"bottoms")),u=n.filter(x=>i(D(x),"tailored")),m=t?d.length>0:!0,v=t?f.length>0:!1,j=t?g.length>0:!1,S=t?u.length>0:!1,N=async x=>{h(x),await new Promise(_=>setTimeout(_,500)),a(x),h(null)},p=x=>{const _=bs(x),L=e.includes(_),R=l===_,O=x.countMen||0,w=x.countWomen||0,k=c==="men"?O>0:c==="women"?w>0:O>0||w>0,P=Cs(D(x));return s.jsx(E,{onClick:()=>N(_),loading:R,loadingReverse:L,loadingType:"overlay",disabled:R||!k,className:G("block border border-transparent uppercase md:hover:border-textColor",{"border-textColor":L}),children:P},_)};if(!t)return s.jsxs("div",{className:"space-y-6",children:[r&&s.jsx(b,{variant:"uppercase",children:r}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:n.map(p)})]});const I=[m,v,j,S].filter(Boolean).length>1;return s.jsxs("div",{className:G("grid",{"gap-y-7":I}),children:[m&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:r||"size"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:d.map(p)})]}),S&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:"tailored"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:u.map(p)})]}),j&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:"bottoms"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:g.map(p)})]}),v&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:"shoe size"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:f.map(p)})]})]})}function Le({filterKey:e,multiSelect:n=!1}){const{dictionary:r}=z(),{defaultValue:t,handleFilterChange:c}=y(e),a=(r==null?void 0:r[e==="size"?"sizes":"collections"])||[],l=Array.isArray(t)?t:t?t.split(","):[],i=l.length===0?[]:e==="size"?l.map(u=>a.find(m=>String(m.id)===u)).filter(Boolean):l.map(u=>a.find(m=>{var v;return((v=m.name)==null?void 0:v.toLowerCase())===u.toLowerCase()})).filter(Boolean),o=e==="size"?l.filter(u=>a.some(m=>String(m.id)===u)):i.map(u=>u==null?void 0:u.name),[d,f]=T.useState(o);return T.useEffect(()=>{t||f([])},[t]),{selectedValues:d,handleToggle:async u=>{let m;n?m=d.includes(u)?d.filter(j=>j!==u):[...d,u]:m=d.includes(u)?[]:[u],f(m);const v=m.length>0?m.join(","):void 0;c(v)}}}function ys(){var f;const{dictionary:e}=z(),{topCategory:n}=U(),r=(e==null?void 0:e.sizes)||[],t=e==null?void 0:e.categories,c=n!=null&&n.id?t==null?void 0:t.find(g=>g.id===n.id):void 0,a=(c==null?void 0:c.name)||"",l=a.toLowerCase().includes("shoes"),h=a.toLowerCase().includes("bottoms"),i=a.toLowerCase().includes("tailored"),o=r.filter(g=>{var S;if(!(n!=null&&n.id))return!0;const u=((S=g.name)==null?void 0:S.toLowerCase())||"",m=/^\d+(\.\d+)?$/.test(u),v=/_\d+bo_[mf]$/.test(u),j=/_\d+ta_[mf]$/.test(u);return l?m:h?v:i?j:!m&&!v&&!j});return{sizeOptions:(f=o==null?void 0:o.sort((g,u)=>(g.id??0)-(u.id??0)))==null?void 0:f.map(g=>({...g,name:g.name||""})),filteredSizes:o}}function Oe({gender:e}){const{sizeOptions:n}=ys(),{selectedValues:r,handleToggle:t}=Le({filterKey:"size",multiSelect:!0});return s.jsx(Pe,{selectedValues:r,handleFilterChange:t,values:n||[],showSeparated:!0,gender:e})}function Ss(e,n){const r=n.sale,t=e.label?`${e.label}: `:"";return`${r?r?"sale: ":"":t}${n.name}`}function B(e,n){return Object.keys(n).find(r=>n[r]===e)||""}function Ve(){const{defaultValue:e,handleFilterChange:n}=y("sort"),{defaultValue:r}=y("order"),{defaultValue:t}=y("sale");return s.jsx("div",{className:"mr-16 space-y-2",children:Object.entries(ze).flatMap(([c,a])=>a.orderFactors.map((l,h)=>{const i=e===B(c,q),o=r===B(l.factor,W),d=l.sale?t==="true":!t,f=i&&o&&d;return s.jsx(E,{onClick:()=>{f?n(void 0,{order:"",sale:""}):n(B(c,q),{order:B(l.factor,W),sale:l.sale?"true":""})},className:G("block",{underline:f}),children:Ss(a,l)},`${c}-${h}`)}))})}function ws({isOpen:e,toggleModal:n}){const{gender:r}=U(),[t,c]=F(),a=()=>{c(new URLSearchParams)};return s.jsx("div",{className:"z-50 w-full",children:e&&s.jsxs("div",{className:"hidden lg:block",children:[s.jsx(we,{cover:"screen",onClick:n,disablePointerEvents:!1}),s.jsx("div",{className:"fixed inset-y-2 right-2 z-30 w-[445px] border border-textInactiveColor bg-bgColor p-2.5 text-textColor",children:s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(b,{variant:"uppercase",children:"filter"}),s.jsx(E,{onClick:n,children:"[x]"})]}),s.jsxs("div",{className:"h-full space-y-10 overflow-y-scroll py-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:"sort by"}),s.jsx(Ve,{})]}),s.jsx(Ee,{}),s.jsx(Re,{}),s.jsx(_e,{}),s.jsx(Te,{}),s.jsx(Ie,{}),s.jsx(Oe,{gender:r})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 bg-bgColor",children:[s.jsx(E,{className:"w-1/2 uppercase",variant:"main",size:"lg",onClick:a,children:"clear all"}),s.jsx(E,{className:"w-1/2 uppercase",variant:"main",size:"lg",onClick:()=>n(),children:"show"})]})]})})]})})}function Ts({product:e,refresh:n}){var g,u,m,v,j,S,N,p,I,x,_,L,R,O;const r=(v=(m=(u=(g=e.productDisplay)==null?void 0:g.thumbnail)==null?void 0:u.media)==null?void 0:m.thumbnail)==null?void 0:v.mediaUrl,t=(N=(S=(j=e.productDisplay)==null?void 0:j.productBody)==null?void 0:S.productBodyInsert)==null?void 0:N.hidden,c=`[${e.id}] ${(x=(I=(p=e.productDisplay)==null?void 0:p.productBody)==null?void 0:I.productBodyInsert)==null?void 0:x.brand} ${(O=(R=(L=(_=e.productDisplay)==null?void 0:_.productBody)==null?void 0:L.translations)==null?void 0:R[0])==null?void 0:O.name}`,{showMessage:a}=je(),[l,h]=T.useState(void 0),i=re();async function o(w,k){if(k.stopPropagation(),l===w)try{await te.DeleteProductByID({id:w}),a("PRODUCT WAS SUCCESSFULLY DELETED","success"),h(void 0),n(w)}catch(P){const C=P instanceof Error?P.message:"Failed to delete product";a(C,"error")}else h(w)}const d=w=>{i(`${$.product}/${w}`,{replace:!0})},f=(w,k)=>{k.stopPropagation(),confirm("Are you sure you want to copy this product?")&&i(`${$.copyProduct}/${w}`)};return s.jsxs("div",{className:"space-y-1",onClick:()=>d(e.id),children:[s.jsxs("div",{className:"relative w-full h-full group",children:[s.jsx(Me,{src:r||"",alt:"prod item",type:le(r)?"video":"image",controls:le(r)}),s.jsx(E,{onClick:w=>o(e.id,w),className:"absolute top-0 right-0 p-1 md:group-hover:block md:hidden block",children:l===e.id?s.jsx(De,{}):"[x]"}),s.jsx(E,{size:"lg",className:"absolute bottom-0 left-0 z-30",variant:"main",onClick:w=>f(e.id,w),children:"copy"}),t&&s.jsx(we,{cover:"container"})]}),s.jsx(b,{className:"w-full break-words",variant:"underLineWithColor",children:c})]})}function Is({products:e,refresh:n}){return s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 2xl:grid-cols-6 gap-4",children:e.map(r=>s.jsx("div",{children:s.jsx(Ts,{product:r,refresh:n})},r.id))})}function _s({firstItems:e}){const[n]=F(),[r,t]=T.useState(e),[c,a]=T.useState(!1),{showMessage:l}=je(),{ref:h,inView:i}=$e(),o=T.useRef(2),d=T.useRef(!0),[f,g]=T.useState(!0),u=T.useRef(!1);T.useEffect(()=>{t(e);const p=n.has("limit");d.current=!p,g(!p),o.current=2,a(!1)},[e,n]);const m=Object.fromEntries(n.entries()),v=m.limit?Math.max(1,parseInt(m.limit,10)||A):A,j=n.has("limit"),S=async()=>{if(!d.current||c){console.log("Skipping load:",{hasMore:d.current,isLoading:c});return}a(!0);try{const p=(o.current-1)*v,x=(await te.GetProductsPaged({limit:v,offset:p,...Ne(m)})).products||[];(!x.length||x.length<v)&&(d.current=!1,g(!1)),o.current+=1,t(_=>[..._,...x])}catch(p){const I=p instanceof Error?p.message:"Failed to fetch more products";l(I,"error")}finally{a(!1)}};T.useEffect(()=>{if(j)return;const p=i&&!u.current;u.current=i,e.length!==0&&p&&d.current&&!c&&S()},[i,n,e.length,j]);function N(p){p&&t(r.filter(I=>I.id!==p))}return s.jsxs("div",{children:[s.jsx(Is,{products:r,refresh:N}),f&&s.jsx("div",{ref:h,className:"text-center",style:{minHeight:"100px"},children:"loading..."})]})}function Es(){const{selectedValues:e,handleToggle:n}=Le({filterKey:"collection",multiSelect:!0}),{dictionary:r}=z(),t=(r==null?void 0:r.collections)||[];return t.length===0?null:s.jsx(Pe,{selectedValues:e,handleFilterChange:n,values:t,title:"collection",showSeparated:!1})}function Rs(){const[e,n]=T.useState(!1),{gender:r}=U(),[t,c]=F(),{defaultValue:a}=y("size"),{defaultValue:l}=y("sort"),{defaultValue:h}=y("order"),{defaultValue:i}=y("sale"),{defaultValue:o}=y("collection"),d=!!a||!!l||!!h||!!i||!!o,f=()=>{c(new URLSearchParams)};return s.jsxs(Ae,{open:e,onOpenChange:n,children:[s.jsx(Ue,{asChild:!0,children:s.jsx(E,{className:"uppercase",children:"filter +"})}),s.jsxs(Be,{children:[s.jsx(qe,{className:"fixed inset-0 z-20 h-screen bg-overlay"}),s.jsxs(We,{className:"fixed inset-x-2 bottom-2 top-2 z-50 border border-textInactiveColor bg-bgColor p-2.5 text-textColor lg:hidden",children:[s.jsx(Ge,{className:"sr-only",children:"mobile menu"}),s.jsxs("div",{className:"flex h-full flex-col justify-between",children:[s.jsx(ce,{asChild:!0,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(b,{variant:"uppercase",children:"filter"}),s.jsx(E,{children:"[x]"})]})}),s.jsxs("div",{className:"h-full space-y-10 overflow-y-scroll pt-10",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx(b,{variant:"uppercase",children:"sort by"}),s.jsx(Ve,{})]}),s.jsx(Ee,{}),s.jsx(Re,{}),s.jsx(_e,{}),s.jsx(Te,{}),s.jsx(Ie,{}),s.jsx(Es,{}),s.jsx(Oe,{gender:r})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 bg-bgColor",children:[s.jsx(E,{className:"w-1/2 uppercase",size:"lg",variant:"simpleReverseWithBorder",onClick:f,disabled:!d,children:"clear all"}),s.jsx(ce,{asChild:!0,children:s.jsx(E,{className:"w-1/2 uppercase",size:"lg",variant:"main",children:"show"})})]})]})]})]})]})}function Ps(){return s.jsxs("div",{className:"w-full overflow-x-scroll space-y-6",children:[s.jsx(Se,{}),s.jsx(Rs,{})]})}function Ds(){const[e]=F(),[n,r]=T.useState([]),[t,c]=T.useState(!1);function a(){c(!t)}const l=Object.fromEntries(e.entries()),h=re(),i={...l,sizes:l.sizes??l.size,hidden:l.hidden??"true"},o=T.useCallback(cs(async g=>{const u=g.limit?Math.max(1,parseInt(g.limit,10)||A):A,m=await te.GetProductsPaged({limit:u,offset:0,...Ne(g)});r(m.products||[])},1e3),[]),d=e.toString();T.useEffect(()=>(o(i),()=>o.cancel()),[d,o]);const f=()=>{h(`${$.addProduct}`)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"block lg:hidden",children:s.jsx(Ps,{})}),s.jsxs("div",{className:"flex flex-col grid gap-10 pb-20",children:[s.jsxs("div",{className:"hidden lg:flex items-end justify-between",children:[s.jsx(Se,{}),s.jsx(E,{className:"uppercase",onClick:a,children:"filter +"})]}),s.jsx(ws,{isOpen:t,toggleModal:a}),s.jsx(_s,{firstItems:n})]}),s.jsx(E,{variant:"main",className:"fixed bottom-4 right-4 z-20",size:"lg",onClick:f,children:"create new"})]})}export{Ds as default};
