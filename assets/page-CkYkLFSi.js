import{j as r}from"./mui-Era5zkYQ.js";import{S as R,z as B,T as k,a as ce,t as de,d as ue,af as J,B as M,A as fe,ag as me,R as G,b as W,ah as he}from"./index-D2NYSwrw.js";import{g as ge,k as U,j as pe,u as H,r as C}from"./vendor-BOSvJ31v.js";import{b as xe,r as ve,d as be,a as se}from"./isObjectLike-GPVlP2no.js";import{c as je,g as Ce,a as K,o as Q}from"./filter-Cj9eQRwK.js";import{C as _}from"./checkbox-CUiSRbSV.js";var D,Z;function Se(){if(Z)return D;Z=1;var e=xe(),n=function(){return e.Date.now()};return D=n,D}var A,ee;function ye(){if(ee)return A;ee=1;var e=/\s/;function n(t){for(var a=t.length;a--&&e.test(t.charAt(a)););return a}return A=n,A}var q,re;function Ie(){if(re)return q;re=1;var e=ye(),n=/^\s+/;function t(a){return a&&a.slice(0,e(a)+1).replace(n,"")}return q=t,q}var L,ne;function Ee(){if(ne)return L;ne=1;var e=ve(),n=be(),t="[object Symbol]";function a(i){return typeof i=="symbol"||n(i)&&e(i)==t}return L=a,L}var V,te;function Te(){if(te)return V;te=1;var e=Ie(),n=se(),t=Ee(),a=NaN,i=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,o=/^0o[0-7]+$/i,x=parseInt;function l(s){if(typeof s=="number")return s;if(t(s))return a;if(n(s)){var c=typeof s.valueOf=="function"?s.valueOf():s;s=n(c)?c+"":c}if(typeof s!="string")return s===0?s:+s;s=e(s);var f=d.test(s);return f||o.test(s)?x(s.slice(2),f?2:8):i.test(s)?a:+s}return V=l,V}var $,ae;function Pe(){if(ae)return $;ae=1;var e=se(),n=Se(),t=Te(),a="Expected a function",i=Math.max,d=Math.min;function o(x,l,s){var c,f,u,v,m,p,g=0,P=!1,S=!1,I=!0;if(typeof x!="function")throw new TypeError(a);l=t(l)||0,e(s)&&(P=!!s.leading,S="maxWait"in s,u=S?i(t(s.maxWait)||0,l):u,I="trailing"in s?!!s.trailing:I);function E(h){var y=c,F=f;return c=f=void 0,g=h,v=x.apply(F,y),v}function O(h){return g=h,m=setTimeout(N,l),P?E(h):v}function b(h){var y=h-p,F=h-g,Y=l-y;return S?d(Y,u-F):Y}function T(h){var y=h-p,F=h-g;return p===void 0||y>=l||y<0||S&&F>=u}function N(){var h=n();if(T(h))return X(h);m=setTimeout(N,b(h))}function X(h){return m=void 0,I&&c?E(h):(c=f=void 0,v)}function oe(){m!==void 0&&clearTimeout(m),g=0,c=p=f=m=void 0}function le(){return m===void 0?v:X(n())}function w(){var h=n(),y=T(h);if(c=arguments,f=this,p=h,y){if(m===void 0)return O(p);if(S)return clearTimeout(m),m=setTimeout(N,l),E(p)}return m===void 0&&(m=setTimeout(N,l)),v}return w.cancel=oe,w.flush=le,w}return $=o,$}var Ne=Pe();const Fe=ge(Ne);function j(e,n=!1){const[t]=U(),a=pe().pathname,i=H();function d(l,s){const c=new URLSearchParams(t);l?Array.isArray(l)?l.length>0?c.set(e,l.join(",")):c.delete(e):c.set(e,l):c.delete(e),s&&Object.entries(s).forEach(([f,u])=>{u?c.set(f,u):c.delete(f)}),i(`${a}?${c.toString()}`,{replace:!0})}const o=t.get(e);return{defaultValue:n?(o==null?void 0:o.split(","))||[]:o||"",handleFilterChange:d}}function Re(){const{defaultValue:e,handleFilterChange:n}=j("color"),t=je.map(a=>({value:a.name.toLowerCase(),label:a.name}));return r.jsx(R,{label:"color",options:t,value:e||"",onChange:a=>n(a),showAll:!0})}function Oe(){const{defaultValue:e,handleFilterChange:n}=j("from"),{defaultValue:t,handleFilterChange:a}=j("to");return r.jsxs("div",{className:"flex gap-3",children:[r.jsx(B,{type:"number",placeholder:"price from",name:"from",value:e||"",onChange:i=>n(i.target.value)}),r.jsx(B,{type:"number",placeholder:"price to",name:"to",value:t||"",onChange:i=>a(i.target.value)})]})}function ke(){const{defaultValue:e,handleFilterChange:n}=j("gender");return r.jsx(R,{label:"gender",value:e||[],options:Ce,onChange:n,showAll:!0})}function we(){const{defaultValue:e,handleFilterChange:n}=j("preorder"),{defaultValue:t,handleFilterChange:a}=j("hidden"),{defaultValue:i,handleFilterChange:d}=j("sale");return r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_,{name:"preorder",label:"preorder",checked:e==="true",onChange:o=>n(o.toString())}),r.jsx(k,{variant:"uppercase",size:"small",children:"preorder"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_,{name:"hidden",label:"hidden",checked:t==="true",onChange:o=>a(o.toString())}),r.jsx(k,{variant:"uppercase",size:"small",children:"hidden"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(_,{name:"sale",label:"sale",checked:i==="true",onChange:o=>d(o.toString())}),r.jsx(k,{variant:"uppercase",size:"small",children:"sale"})]})]})}function _e(){var i;const{dictionary:e}=ce(),{defaultValue:n,handleFilterChange:t}=j("sizes",!0),a=((i=e==null?void 0:e.sizes)==null?void 0:i.map(d=>{var o;return{value:((o=d.id)==null?void 0:o.toString())??"",label:d.name??""}}))||[];return r.jsx(R,{label:"sizes",options:a,value:n||[],showAll:!0,multiple:!0,onChange:t})}function De(){const{defaultValue:e,handleFilterChange:n}=j("sort"),{defaultValue:t,handleFilterChange:a}=j("order");return r.jsxs(r.Fragment,{children:[r.jsx(R,{label:"Sort By",value:e||K[0].value,options:K,onChange:i=>n(i)}),r.jsx(R,{label:"Order",value:t||Q[0].value,options:Q,onChange:i=>a(i)})]})}function Ae(){const{defaultValue:e,handleFilterChange:n}=j("tag");return r.jsx("div",{children:r.jsx(B,{type:"text",name:"tag",placeholder:"enter tag",value:e||"",onChange:t=>n(t.target.value)})})}function qe(){return r.jsxs("div",{className:"grid gap-3",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[r.jsx(De,{}),r.jsx(ke,{}),r.jsx(Re,{}),r.jsx(_e,{})]}),r.jsxs("div",{className:"flex lg:flex-row lg:justify-between flex-col gap-3",children:[r.jsxs("div",{className:"flex gap-3 flex-col lg:flex-row",children:[r.jsx(Oe,{}),r.jsx(Ae,{})]}),r.jsx(we,{})]})]})}function Le({product:e,refresh:n}){var f,u,v,m,p,g,P,S,I,E,O;const t=(m=(v=(u=(f=e.productDisplay)==null?void 0:f.thumbnail)==null?void 0:u.media)==null?void 0:v.thumbnail)==null?void 0:m.mediaUrl,a=`[${e.id}] ${(P=(g=(p=e.productDisplay)==null?void 0:p.productBody)==null?void 0:g.productBodyInsert)==null?void 0:P.brand} ${(O=(E=(I=(S=e.productDisplay)==null?void 0:S.productBody)==null?void 0:I.translations)==null?void 0:E[0])==null?void 0:O.name}`,{showMessage:i}=de(),[d,o]=C.useState(void 0),x=H();async function l(b,T){T.stopPropagation(),d===b?await W.DeleteProductByID({id:b})&&(i("PRODUCT WAS SUCCESSFULLY DELETED","success"),o(void 0),n(b)):o(b)}const s=b=>{x(`${G.product}/${b}`,{replace:!0})},c=(b,T)=>{T.stopPropagation(),x(`${G.copyProduct}/${b}`)};return r.jsxs("div",{className:"space-y-1",onClick:()=>s(e.id),children:[r.jsxs("div",{className:"relative w-full h-full group",children:[r.jsx(ue,{src:t||"",alt:"prod item",type:J(t)?"video":"image",controls:J(t)}),r.jsx(M,{onClick:b=>l(e.id,b),className:"absolute top-0 right-0 p-1 md:group-hover:block md:hidden block",children:d===e.id?r.jsx(fe,{}):r.jsx(me,{})}),r.jsx(M,{size:"lg",className:"absolute bottom-0 left-0",onClick:b=>c(e.id,b),children:"copy"})]}),r.jsx(k,{className:"w-full break-words",variant:"underLineWithColor",size:"small",children:a})]})}function Ve({products:e,refresh:n}){return r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 2xl:grid-cols-6 gap-4",children:e.map(t=>r.jsx("div",{children:r.jsx(Le,{product:t,refresh:n})},t.id))})}function ie({sort:e="SORT_FACTOR_CREATED_AT",order:n="ORDER_FACTOR_DESC",topCategories:t,subCategories:a,types:i,gender:d,sizes:o,tag:x,color:l,from:s,to:c,sale:f,preorder:u,hidden:v,collections:m,currency:p}){return{sortFactors:e?[e]:void 0,orderFactor:n||void 0,filterConditions:{from:s||void 0,to:c||void 0,gender:d?[d]:void 0,color:l||void 0,topCategoryIds:t?t.split(",").map(g=>parseInt(g)):void 0,subCategoryIds:a?a.split(",").map(g=>parseInt(g)):void 0,typeIds:i?i.split(",").map(g=>parseInt(g)):void 0,sizesIds:o?o.split(",").map(g=>parseInt(g)):void 0,byTag:x||void 0,preorder:u?u==="true":void 0,onSale:f?f==="true":void 0,collections:m?m.split(","):void 0,currency:p||void 0},showHidden:v?v==="true":void 0}}const z=16;function $e({firstItems:e}){const[n]=U(),[t,a]=C.useState(e),[i,d]=C.useState(!1),{ref:o,inView:x}=he(),l=C.useRef(2),s=C.useRef(!0);C.useEffect(()=>{a(e),s.current=!0,l.current=2,d(!1)},[e,n]);const c=async()=>{if(!s.current||i){console.log("Skipping load:",{hasMore:s.current,isLoading:i});return}d(!0);try{const u=Object.fromEntries(n.entries()),v=(l.current-1)*z,p=(await W.GetProductsPaged({limit:z,offset:v,...ie(u)})).products||[];(!p.length||p.length<z)&&(s.current=!1),l.current+=1,a(g=>[...g,...p])}catch(u){console.error("Failed to fetch more products:",u)}finally{d(!1)}};C.useEffect(()=>{x&&s.current&&!i&&c()},[x,n]);function f(u){u&&a(t.filter(v=>v.id!==u))}return r.jsxs("div",{children:[r.jsx(Ve,{products:t,refresh:f}),s.current&&r.jsx("div",{ref:o,className:"text-center text-xl",style:{minHeight:"100px"},children:"loading..."})]})}const ze=16;function Xe(){const[e]=U(),n=Object.fromEntries(e.entries()),[t,a]=C.useState([]),i=H(),d=C.useCallback(Fe(async x=>{const l=await W.GetProductsPaged({limit:ze,offset:0,...ie(x)});a(l.products||[])},1e3),[]);C.useEffect(()=>(d(n),()=>d.cancel()),[e,d]);const o=()=>{i(`${G.addProduct}`)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col grid gap-10 pb-20",children:[r.jsx(qe,{}),r.jsx($e,{firstItems:t})]}),r.jsx(M,{className:"fixed bottom-4 right-4 z-20",size:"lg",onClick:o,children:"create new"})]})}export{Xe as default};
