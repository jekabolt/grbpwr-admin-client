import{j as e,aS as $}from"./mui--1QQx6Xz.js";import{T as r,c as j,B as z,C as I,y as O,R as P,z as U,A as y,P as R,a as b,b as T,L}from"./index-CeC5ghbp.js";import{r as N,e as H}from"./vendor-BqCw_tH9.js";import{S as C}from"./filter-Ct7KBysK.js";import{f as k,g as B,a as Y}from"./utility-H7oHWue3.js";function M({shipping:a}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{variant:"uppercase",size:"small",children:`street adress: ${a==null?void 0:a.addressLineOne}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`city: ${a==null?void 0:a.city}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`state: ${a==null?void 0:a.state}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`country: ${a==null?void 0:a.country}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`postal code: ${a==null?void 0:a.postalCode}`})]})}function F({orderDetails:a,isPrinting:n}){var d;const s=(d=a==null?void 0:a.billing)==null?void 0:d.addressInsert,[l,t]=N.useState(!1);return e.jsx("div",{className:j("block",{hidden:n}),children:l?e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{variant:"uppercase",className:"font-bold",children:"billing address:"}),e.jsx(M,{shipping:s})]}):e.jsx(z,{onClick:()=>t(!l),size:"lg",children:"show billing info"})})}function G({buyer:a,isPrinting:n}){return e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsx(r,{variant:"uppercase",className:"font-bold",children:"buyer information:"}),e.jsx(r,{className:"flex items-center gap-2",variant:"uppercase",size:"small",children:["email: ",e.jsx(r,{component:"span",className:"lowercase",children:e.jsx(I,{text:(a==null?void 0:a.email)||""})})]}),e.jsx(r,{variant:"uppercase",size:"small",children:`first name: ${a==null?void 0:a.firstName}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`last name: ${a==null?void 0:a.lastName}`}),e.jsx(r,{variant:"uppercase",size:"small",children:`phone: ${a==null?void 0:a.phone}`}),e.jsx(r,{variant:"uppercase",size:"small",className:j({hidden:n}),children:["receive promo emails: ",a!=null&&a.receivePromoEmails?e.jsx(r,{component:"span",size:"small",className:C.confirmed,children:"yes"}):e.jsx(r,{component:"span",size:"small",className:C.denied,children:"no"})]})]})}function V({orderDetails:a,orderStatus:n,isPrinting:s}){var o,u,m,p;const l=B(n),t=k((o=a==null?void 0:a.order)==null?void 0:o.placed),d=k((u=a==null?void 0:a.order)==null?void 0:u.modified);return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[e.jsx(r,{variant:"uppercase",size:"small",className:j("block",{"print:hidden":s}),children:`order id: ${(m=a==null?void 0:a.order)==null?void 0:m.id}`}),e.jsx(r,{variant:"uppercase",size:"small",className:j("flex items-center",{"print:hidden":s}),children:["uuid: ",e.jsx(I,{text:((p=a==null?void 0:a.order)==null?void 0:p.uuid)||"",cutText:!0},"copy")]}),e.jsx(r,{variant:"uppercase",className:j(l,{"print:hidden":s}),size:"small",children:`status: ${n}`}),e.jsx(r,{variant:"uppercase",size:"small",className:j("block",{"print:hidden":s}),children:"company adress: adress adress adress"}),e.jsx(r,{variant:"uppercase",size:"small",children:`placed: ${t}`}),e.jsx(r,{variant:"uppercase",size:"small",className:j("block",{"print:hidden":s}),children:`modified: ${d}`})]})}const q=(a,n)=>[{field:"thumbnail",headerName:"",align:"center",width:200,renderCell:s=>e.jsx("a",{href:`${O}/#${P.singleProduct}/${s.row.orderItem.productId}`,target:"_blank",style:{cursor:"pointer"},children:e.jsx("img",{src:s.value,alt:"product",style:{height:"100px",width:"auto"}})})},{field:"sku",headerName:"SKU",align:"center",width:n?150:300,renderCell:s=>e.jsx("div",{style:{whiteSpace:n?"normal":"nowrap",wordWrap:n?"break-word":"normal",overflow:n?"visible":"auto",display:n?"block":"flex",alignItems:"center",lineHeight:n?"1.5":"normal",height:"100%",width:"100%",margin:n?"30% auto":"0"},children:s.value})},{field:"productName",align:"center",headerAlign:"center",headerName:"PRODUCT NAME",width:150},{field:"quantity",headerName:"QUANTITY",headerAlign:"center",align:"center",width:n?100:200,valueGetter:(s,l)=>l.orderItem.quantity},{field:"size",headerName:"SIZE",align:"center",headerAlign:"center",width:200,cellClassName:"print:hidden",valueGetter:(s,l)=>{var t,d,o;return(o=(d=(t=a==null?void 0:a.sizes)==null?void 0:t.find(u=>u.id===l.orderItem.sizeId))==null?void 0:d.name)==null?void 0:o.replace("SIZE_ENUM_","")}},{field:"productPrice",headerName:"PRICE",align:"center",headerAlign:"center",width:n?90:200,valueGetter:(s,l)=>`${s*l.orderItem.quantity} ${a==null?void 0:a.baseCurrency}`},{field:"productSalePercentage",headerName:"SALE",align:"center",headerAlign:"center",width:n?90:200},{field:"productPriceWithSale",align:"center",headerAlign:"center",headerName:n?"PWS":"PRICE WITH SALE",width:n?100:200}];function W({orderDetails:a,isPrinting:n}){var l,t,d,o,u,m,p,f,v,x,w,g,E,c,i,h,S,A;const s=a==null?void 0:a.payment;return e.jsxs("div",{className:j("grid gap-2 w-full",{hidden:n}),children:[e.jsx(r,{variant:"uppercase",className:"font-bold",children:"payment:"}),e.jsxs(r,{variant:"uppercase",size:"small",children:["status:"," ",(l=s==null?void 0:s.paymentInsert)!=null&&l.isTransactionDone?e.jsx(r,{component:"span",size:"small",className:C.confirmed,children:"paid"}):e.jsx(r,{component:"span",size:"small",className:C.denied,children:"unpaid"})]}),e.jsxs(r,{variant:"uppercase",size:"small",children:["made at: ",k(s==null?void 0:s.modifiedAt)]}),e.jsxs(r,{variant:"uppercase",size:"small",children:["payment method:"," ",(d=(t=s==null?void 0:s.paymentInsert)==null?void 0:t.paymentMethod)==null?void 0:d.replace("PAYMENT_METHOD_NAME_ENUM_","")]}),e.jsx(r,{variant:"uppercase",size:"small",children:["amount: ",((o=s==null?void 0:s.paymentInsert)==null?void 0:o.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD"||((u=s==null?void 0:s.paymentInsert)==null?void 0:u.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD_TEST"?e.jsx("span",{children:(p=(m=s==null?void 0:s.paymentInsert)==null?void 0:m.transactionAmountPaymentCurrency)==null?void 0:p.value}):e.jsx("span",{children:(v=(f=s==null?void 0:s.paymentInsert)==null?void 0:f.transactionAmount)==null?void 0:v.value})]}),((x=s==null?void 0:s.paymentInsert)==null?void 0:x.payer)&&e.jsx(r,{variant:"uppercase",size:"small",className:"flex items-center gap-2",children:["payer: ",e.jsx(I,{text:((w=s==null?void 0:s.paymentInsert)==null?void 0:w.payer)||""})]}),((g=s==null?void 0:s.paymentInsert)==null?void 0:g.payee)&&e.jsx(r,{variant:"uppercase",size:"small",className:"flex items-center gap-2",children:["payee: ",e.jsx(I,{text:((E=s==null?void 0:s.paymentInsert)==null?void 0:E.payee)||""})]}),((c=s==null?void 0:s.paymentInsert)==null?void 0:c.isTransactionDone)&&e.jsx(r,{variant:"uppercase",size:"small",className:"flex items-center gap-2",children:((i=s.paymentInsert)==null?void 0:i.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD_TEST"||((h=s.paymentInsert)==null?void 0:h.paymentMethod)==="PAYMENT_METHOD_NAME_ENUM_CARD"?["client secret: ",e.jsx(I,{text:((S=s==null?void 0:s.paymentInsert)==null?void 0:S.clientSecret)||"",cutText:!0})]:["txid: ",e.jsx(I,{text:((A=s==null?void 0:s.paymentInsert)==null?void 0:A.transactionId)||"",cutText:!0})]})]})}function Z({orderDetails:a}){var s,l;const n=(s=a==null?void 0:a.promoCode)==null?void 0:s.promoCodeInsert;return n&&e.jsxs("div",{className:"flex flex-row lg:flex-col gap-2",children:[e.jsx(r,{variant:"uppercase",className:"font-bold",children:`promo applied: ${n.code} - ${(l=n.discount)==null?void 0:l.value}%`}),n.freeShipping&&e.jsx(r,{variant:"uppercase",size:"small",children:"free ship"}),n.voucher&&e.jsx(r,{variant:"uppercase",size:"small",children:"voucher"})]})}function _({trackingNumber:a,isPrinting:n,handleTrackingNumberChange:s,saveTrackingNumber:l}){return e.jsx("div",{className:j("w-full lg:w-1/4",{hidden:n}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{name:"trackingNumber",placeholder:"tracking number",value:a,onChange:s,className:"h-10"}),e.jsx(z,{onClick:l,size:"lg",children:e.jsx(y,{})})]})})}function K({isEdit:a,isPrinting:n,trackingNumber:s,orderStatus:l,orderDetails:t,toggleTrackNumber:d,handleTrackingNumberChange:o,saveTrackingNumber:u}){var m,p;return e.jsx(e.Fragment,{children:((m=t==null?void 0:t.shipment)==null?void 0:m.trackingCode)&&e.jsx("div",{children:a&&!n?e.jsx(_,{isPrinting:n,trackingNumber:s,handleTrackingNumberChange:o,saveTrackingNumber:u}):!n&&e.jsx(r,{variant:"uppercase",size:"small",children:[`tracking number: ${(p=t==null?void 0:t.shipment)==null?void 0:p.trackingCode} `,l==="SHIPPED"&&e.jsx(z,{onClick:d,size:"sm",children:e.jsx(R,{})})]})})})}function Q({orderDetails:a,isPrinting:n,orderStatus:s,isEdit:l,trackingNumber:t,toggleTrackNumber:d,handleTrackingNumberChange:o,saveTrackingNumber:u}){var f,v,x;const{dictionary:m}=b(),p=(f=a==null?void 0:a.shipping)==null?void 0:f.addressInsert;return e.jsx("div",{className:"w-full",children:p&&e.jsxs("div",{className:"grid gap-2 w-full",children:[e.jsx(r,{variant:"uppercase",className:"font-bold",children:"shipping:"}),e.jsx(M,{shipping:p}),e.jsx(r,{variant:"uppercase",size:"small",children:`cost: ${(x=(v=a==null?void 0:a.shipment)==null?void 0:v.cost)==null?void 0:x.value} ${m==null?void 0:m.baseCurrency}`}),e.jsx(K,{isEdit:l,isPrinting:n,trackingNumber:t,orderStatus:s||"",orderDetails:a,toggleTrackNumber:d,handleTrackingNumberChange:o,saveTrackingNumber:u})]})})}const J=a=>{const{dictionary:n}=b(),[s,l]=N.useState({orderDetails:void 0,dictionary:void 0,orderStatus:void 0,isLoading:!1}),[t,d]=N.useState(!1),[o,u]=N.useState(!1),[m,p]=N.useState("");async function f(){l(c=>({...c,isLoading:!0}));try{const c=await T.GetOrderByUUID({orderUuid:a});l(i=>{var h,S;return{...i,orderDetails:c.order,dictionary:n,orderStatus:Y(n,(S=(h=c.order)==null?void 0:h.order)==null?void 0:S.orderStatusId)}})}catch(c){console.error("Error fetching order details:",c)}finally{l(c=>({...c,isLoading:!1}))}}N.useEffect(()=>{f()},[a,n]),N.useEffect(()=>{const c=()=>d(!0),i=()=>d(!1);return window.addEventListener("beforeprint",c),window.addEventListener("afterprint",i),()=>{window.removeEventListener("beforeprint",c),window.removeEventListener("afterprint",i)}},[]);const v=()=>{var c,i;!t&&s.orderStatus==="SHIPPED"&&(u(!o),o&&p(((i=(c=s.orderDetails)==null?void 0:c.shipment)==null?void 0:i.trackingCode)||""))};function x(c){p(c.target.value)}const w=async()=>{var i,h;if(!m.trim()){u(!1);return}await T.SetTrackingNumber({orderUuid:(h=(i=s.orderDetails)==null?void 0:i.order)==null?void 0:h.uuid,trackingCode:m})&&(f(),u(!1))};async function g(){var i,h;await T.DeliveredOrder({orderUuid:(h=(i=s.orderDetails)==null?void 0:i.order)==null?void 0:h.uuid})&&f()}async function E(){var i,h;await T.RefundOrder({orderUuid:(h=(i=s.orderDetails)==null?void 0:i.order)==null?void 0:h.uuid})&&f()}return{...s,isPrinting:t,isEdit:o,trackingNumber:m,saveTrackingNumber:w,toggleTrackNumber:v,handleTrackingNumberChange:x,markAsDelivered:g,refundOrder:E}};function ne(){var g,E,c,i,h;const{uuid:a}=H(),{orderDetails:n,dictionary:s,orderStatus:l,isPrinting:t,isEdit:d,trackingNumber:o,toggleTrackNumber:u,handleTrackingNumberChange:m,saveTrackingNumber:p,markAsDelivered:f,refundOrder:v}=J(a||""),[x,w]=N.useState({showBilling:!1,page:0,pageSize:5,columnVisibility:{thumbnail:!0,size:!0}});return N.useEffect(()=>{w(S=>({...S,columnVisibility:{thumbnail:!t,size:!t}}))},[t]),e.jsxs("div",{className:"flex flex-col gap-4",children:[t&&e.jsx("div",{className:"self-start h-10 pt-2",children:e.jsx(L,{})}),e.jsx(V,{orderDetails:n,orderStatus:l,isPrinting:!0}),e.jsx($,{rows:(n==null?void 0:n.orderItems)||[],columns:q(s,t),columnVisibilityModel:x.columnVisibility,rowSelection:!1,paginationModel:t?{page:x.page,pageSize:((g=n==null?void 0:n.orderItems)==null?void 0:g.length)||x.pageSize}:{page:x.page,pageSize:x.pageSize},pageSizeOptions:[5,10,20],rowHeight:100,hideFooterPagination:t,hideFooter:t}),e.jsx("div",{className:j("block",{hidden:t}),children:e.jsx(Z,{orderDetails:n})}),e.jsxs("div",{className:j("flex flex-col lg:flex-row justify-between gap-4",{"flex-row items-start":t}),children:[e.jsx(W,{orderDetails:n,isPrinting:t}),e.jsx(Q,{orderDetails:n,isPrinting:t,orderStatus:l,isEdit:d,trackingNumber:o,toggleTrackNumber:u,handleTrackingNumberChange:m,saveTrackingNumber:p}),e.jsx(G,{buyer:(E=n==null?void 0:n.buyer)==null?void 0:E.buyerInsert,isPrinting:t})]}),e.jsx(F,{orderDetails:n,isPrinting:t}),l==="CONFIRMED"&&!((c=n==null?void 0:n.shipment)!=null&&c.trackingCode)&&e.jsx(_,{isPrinting:t,trackingNumber:o,handleTrackingNumberChange:m,saveTrackingNumber:p}),l==="SHIPPED"&&e.jsx(z,{onClick:f,children:"mark as delivered"}),l==="CONFIRMED"||l==="DELIVERED"&&e.jsx(z,{onClick:v,children:"refund order"}),e.jsx(r,{variant:"uppercase",className:"font-bold self-end",children:`Total: ${(h=(i=n==null?void 0:n.order)==null?void 0:i.totalPrice)==null?void 0:h.value} ${s==null?void 0:s.baseCurrency}`}),e.jsx(r,{variant:"uppercase",size:"small",className:"font-bold",children:"If you have any questions, please send an email to customercare@grbpwr.com"})]})}export{ne as OrderDetails};
