import{j as e}from"./mui-DmsMUjzh.js";import{u as T,r as i}from"./vendor-DljJgkTU.js";import{a as _,K as I,x as w,c as j,B as y,T as g,J as R,S as A,y as F,V as P,W as k,b as L}from"./index-C2EAb9Pf.js";import{s as N}from"./filter-BdRRXWa8.js";function $({orders:a,orderFactor:s,status:l,orderSearch:h,isLoading:o,onToggleSort:m,onStatusChange:c,onOrderSearchChange:d}){var C;const{dictionary:b}=_(),p=T(),S=r=>{p(`${P.orders}/${r.uuid}`)},O=l?(C=N.find(r=>r.value===l))==null?void 0:C.label:null,u=[{label:"Order ID",accessor:r=>r.id},{label:"Order Status",accessor:r=>O??I(b,r.orderStatusId)},{label:"Placed",accessor:r=>w(r.placed)},{label:"Total",accessor:r=>{var t;return`${(t=r.totalPrice)==null?void 0:t.value} ${r.currency}`}}];return e.jsx("div",{className:"w-full flex flex-col gap-4",children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-textColor min-w-max",children:[e.jsx("thead",{className:"bg-textInactiveColor h-10 overflow-x-scroll",children:e.jsx("tr",{className:"border-b border-textColor",children:u.map(r=>e.jsx("th",{className:j("text-center h-10 min-w-26 border border-r border-textColor px-2",{"sticky left-0 bg-textInactiveColor z-10":r.label==="Order ID"}),children:r.label==="Order ID"?e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs(y,{onClick:m,disabled:o,className:"flex items-center justify-center gap-1 whitespace-nowrap hover:opacity-70 transition-opacity",children:[e.jsx("div",{className:"flex items-center gap-1 leading-none",children:["↑","↓"].map((t,x)=>e.jsx(g,{className:j("text-textColor",{"opacity-50":x===0&&s==="ORDER_FACTOR_DESC"||x===1&&s==="ORDER_FACTOR_ASC"}),children:t},t))}),e.jsx(g,{variant:"uppercase",children:r.label})]}),e.jsx(R,{name:"orderSearch",type:"text",placeholder:"order reference",value:h,onChange:t=>d(t.target.value),disabled:o,className:"w-40 bg-textInactiveColor placeholder:text-textColor placeholder:text-center"})]}):r.label==="Order Status"?e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(g,{className:"",variant:"uppercase",children:r.label}),e.jsx(A,{label:"",options:[{value:"all",label:"all"},...N],onChange:t=>c(t==="all"?"":t),value:l||"all",compact:!0,disabled:o})]}):e.jsx(g,{variant:"uppercase",children:r.label})},r.label))})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:u.length,className:"text-center py-8",children:e.jsx(g,{variant:"uppercase",children:"no orders found"})})}):a.map(r=>e.jsx("tr",{className:"group border-b border-text last:border-b-0 h-10 hover:bg-highlightColor/20 cursor-pointer transition-colors",onClick:()=>S(r),children:u.map(t=>{const x=t.accessor(r),f=t.label==="Order Status"?F(String(x)):"";return e.jsx("td",{className:j("border border-r border-textColor text-center px-2",f,{"sticky left-0 bg-bgColor group-hover:bg-highlightColor/20 z-10":t.label==="Order ID",uppercase:t.label==="Order Status"}),children:e.jsx(g,{children:x})},t.label)})},r.id))})]})})})}const v={all:["order"],orders:a=>[...v.all,"orders",a],order:a=>[...v.orders(),a]};function M(a){const s=a.trim();return s?/^\d+$/.test(s)?{orderId:Number(s)}:{orderUuid:s}:{}}function U(a=50,s="ORDER_FACTOR_DESC",l,h,o){const{orderId:m,orderUuid:c}=M(o??"");return k({queryKey:[...v.orders(s),l,h,m,c],queryFn:async({pageParam:d})=>{var p;const b=await L.ListOrders({limit:a,offset:d,orderFactor:s,status:h,paymentMethod:void 0,email:l,orderId:m,orderUuid:c});return{orders:b.orders||[],nextOffset:((p=b.orders)==null?void 0:p.length)===a?d+a:void 0}},getNextPageParam:d=>d.nextOffset,initialPageParam:0,staleTime:300*1e3})}function V(){const[a,s]=i.useState("ORDER_FACTOR_DESC"),[l,h]=i.useState(""),[o,m]=i.useState(""),[c,d]=i.useState(""),[b,p]=i.useState(""),[S,O]=i.useState("");i.useEffect(()=>{const n=setTimeout(()=>{p(c)},500);return()=>clearTimeout(n)},[c]),i.useEffect(()=>{const n=setTimeout(()=>{O(o)},500);return()=>clearTimeout(n)},[o]);const{data:u,isLoading:C,isError:r,fetchNextPage:t,hasNextPage:x,isFetchingNextPage:f}=U(50,a,b||void 0,l||void 0,S||void 0),E=(u==null?void 0:u.pages.flatMap(n=>n.orders))||[],D=()=>{s(n=>n==="ORDER_FACTOR_ASC"?"ORDER_FACTOR_DESC":"ORDER_FACTOR_ASC")};return e.jsxs("div",{className:"flex flex-col gap-4 pb-16",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(R,{name:"email",type:"text",placeholder:"enter email",value:c,onChange:n=>d(n.target.value),disabled:C||f,className:"w-64"})}),e.jsx($,{orders:E,orderFactor:a,onToggleSort:D,status:l,onStatusChange:h,orderSearch:o,onOrderSearchChange:m,isLoading:C||f}),x&&e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{variant:"main",size:"lg",onClick:()=>t(),disabled:f,children:f?"Loading...":"Load More"})})]})}export{V as OrdersCatalog};
