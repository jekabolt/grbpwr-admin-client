import{j as e}from"./mui-D9Bk7yoK.js";import{u as D,r as o}from"./vendor-DljJgkTU.js";import{a as w,G as _,y as O,B as N,T as b,c as S,E as R,S as I,z as A,R as F,J as P,b as k}from"./index-DP6ujRXh.js";import{s as M}from"./filter-5_j1tY8F.js";function L({orders:a,orderFactor:i,status:d,orderId:x,isLoading:s,onToggleSort:n,onStatusChange:c,onOrderIdChange:m}){const{dictionary:u}=w(),g=D(),C=r=>{g(`${F.orders}/${r.uuid}`)},h=o.useMemo(()=>[{label:"Order ID",accessor:r=>r.id},{label:"Order Status",accessor:r=>_(u,r.orderStatusId)},{label:"Placed",accessor:r=>O(r.placed)},{label:"Modified",accessor:r=>O(r.modified)},{label:"Total",accessor:r=>{var t;return`${(t=r.totalPrice)==null?void 0:t.value} ${u==null?void 0:u.baseCurrency}`}}],[u]);return e.jsx("div",{className:"w-full flex flex-col gap-4",children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-textColor min-w-max",children:[e.jsx("thead",{className:"bg-textInactiveColor h-10 overflow-x-scroll",children:e.jsx("tr",{className:"border-b border-textColor",children:h.map(r=>e.jsx("th",{className:"text-center h-10 min-w-26 border border-r border-textColor px-2",children:r.label==="Order ID"?e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs(N,{onClick:n,disabled:s,className:"flex items-center justify-center gap-1 whitespace-nowrap hover:opacity-70 transition-opacity",children:[e.jsx("div",{className:"flex items-center gap-1 leading-none",children:["↑","↓"].map((t,p)=>e.jsx(b,{className:S("text-textColor",{"opacity-50":p===0&&i==="ORDER_FACTOR_DESC"||p===1&&i==="ORDER_FACTOR_ASC"}),children:t},t))}),e.jsx(b,{variant:"uppercase",children:r.label})]}),e.jsx(R,{name:"orderId",type:"number",placeholder:"order id",value:x,onChange:t=>m(t.target.value),disabled:s,className:"w-16 bg-textInactiveColor [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none placeholder:text-textColor"})]}):r.label==="Order Status"?e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(b,{className:"",variant:"uppercase",children:r.label}),e.jsx(I,{label:"",options:[{value:"all",label:"all"},...M],onChange:t=>c(t==="all"?"":t),value:d||"all",compact:!0,disabled:s})]}):e.jsx(b,{variant:"uppercase",children:r.label})},r.label))})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:h.length,className:"text-center py-8",children:e.jsx(b,{variant:"uppercase",children:"no orders found"})})}):a.map(r=>e.jsx("tr",{className:"border-b border-text last:border-b-0 h-10 hover:bg-highlightColor cursor-pointer transition-colors",onClick:()=>C(r),children:h.map(t=>{const p=t.accessor(r),j=t.label==="Order Status"?A(String(p)):"";return e.jsx("td",{className:S("border border-r border-textColor text-center px-2",j),children:e.jsx(b,{children:p})},t.label)})},r.id))})]})})})}const v={all:["order"],orders:a=>[...v.all,"orders",a],order:a=>[...v.orders(),a]};function $(a=50,i="ORDER_FACTOR_DESC",d,x,s){return P({queryKey:[...v.orders(i),d,x,s],queryFn:async({pageParam:n})=>{var m;const c=await k.ListOrders({limit:a,offset:n,orderFactor:i,status:x,paymentMethod:void 0,email:d,orderId:s?Number(s):void 0});return{orders:c.orders||[],nextOffset:((m=c.orders)==null?void 0:m.length)===a?n+a:void 0}},getNextPageParam:n=>n.nextOffset,initialPageParam:0,staleTime:300*1e3})}function U(){const[a,i]=o.useState("ORDER_FACTOR_DESC"),[d,x]=o.useState(""),[s,n]=o.useState(""),[c,m]=o.useState(""),[u,g]=o.useState(""),[C,h]=o.useState("");o.useEffect(()=>{const l=setTimeout(()=>{g(c)},500);return()=>clearTimeout(l)},[c]),o.useEffect(()=>{const l=setTimeout(()=>{h(s)},500);return()=>clearTimeout(l)},[s]);const{data:r,isLoading:t,isError:p,fetchNextPage:j,hasNextPage:y,isFetchingNextPage:f}=$(50,a,u||void 0,d||void 0,C||void 0),E=(r==null?void 0:r.pages.flatMap(l=>l.orders))||[],T=()=>{i(l=>l==="ORDER_FACTOR_ASC"?"ORDER_FACTOR_DESC":"ORDER_FACTOR_ASC")};return e.jsxs("div",{className:"flex flex-col gap-4 pb-16",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(R,{name:"email",type:"text",placeholder:"enter email",value:c,onChange:l=>m(l.target.value),disabled:t||f,className:"w-64"})}),e.jsx(L,{orders:E,orderFactor:a,onToggleSort:T,status:d,onStatusChange:x,orderId:s,onOrderIdChange:n,isLoading:t||f}),y&&e.jsx("div",{className:"flex justify-center",children:e.jsx(N,{variant:"main",size:"lg",onClick:()=>j(),disabled:f,children:f?"Loading...":"Load More"})})]})}export{U as OrdersCatalog};
