import{j as n}from"./mui--1QQx6Xz.js";import{B as R,a as A,a8 as Se,a9 as ie,aa as B,ab as q,R as D,T as S,c as W,S as xe,z as oe,G as we,ac as Te,q as ve,d as _e,ad as le,A as Ie,ae as Ee,b as se,af as Re}from"./index-CmPjSdpe.js";import{c as Oe,g as Le,a as Pe,D as $}from"./filter-Ct7KBysK.js";import{g as Fe,L as ke,k as z,j as ze,u as re,r as T}from"./vendor-BqCw_tH9.js";import{b as Me,r as Ve,d as De,a as Ce}from"./isObjectLike-Cfdbo5Gm.js";import{S as be}from"./select-B6VDK067.js";import{C as H}from"./checkbox-DQKxI2UC.js";var K,ce;function $e(){if(ce)return K;ce=1;var e=Me(),t=function(){return e.Date.now()};return K=t,K}var Y,de;function Ae(){if(de)return Y;de=1;var e=/\s/;function t(r){for(var s=r.length;s--&&e.test(r.charAt(s)););return s}return Y=t,Y}var X,ue;function Ue(){if(ue)return X;ue=1;var e=Ae(),t=/^\s+/;function r(s){return s&&s.slice(0,e(s)+1).replace(t,"")}return X=r,X}var Z,me;function Be(){if(me)return Z;me=1;var e=Ve(),t=De(),r="[object Symbol]";function s(c){return typeof c=="symbol"||t(c)&&e(c)==r}return Z=s,Z}var J,fe;function qe(){if(fe)return J;fe=1;var e=Ue(),t=Ce(),r=Be(),s=NaN,c=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;function a(i){if(typeof i=="number")return i;if(r(i))return s;if(t(i)){var u=typeof i.valueOf=="function"?i.valueOf():i;i=t(u)?u+"":u}if(typeof i!="string")return i===0?i:+i;i=e(i);var h=o.test(i);return h||l.test(i)?f(i.slice(2),h?2:8):c.test(i)?s:+i}return J=a,J}var Q,he;function We(){if(he)return Q;he=1;var e=Ce(),t=$e(),r=qe(),s="Expected a function",c=Math.max,o=Math.min;function l(f,a,i){var u,h,d,m,g,v,C=0,y=!1,j=!1,p=!0;if(typeof f!="function")throw new TypeError(s);a=r(a)||0,e(i)&&(y=!!i.leading,j="maxWait"in i,d=j?c(r(i.maxWait)||0,a):d,p="trailing"in i?!!i.trailing:p);function w(b){var F=u,M=h;return u=h=void 0,C=b,m=f.apply(M,F),m}function x(b){return C=b,g=setTimeout(E,a),y?w(b):m}function _(b){var F=b-v,M=b-C,ae=a-F;return j?o(ae,d-M):ae}function L(b){var F=b-v,M=b-C;return v===void 0||F>=a||F<0||j&&M>=d}function E(){var b=t();if(L(b))return P(b);g=setTimeout(E,_(b))}function P(b){return g=void 0,p&&u?w(b):(u=h=void 0,m)}function N(){g!==void 0&&clearTimeout(g),C=0,u=v=h=g=void 0}function k(){return g===void 0?m:P(t())}function O(){var b=t(),F=L(b);if(u=arguments,h=this,v=b,F){if(g===void 0)return x(v);if(j)return clearTimeout(g),g=setTimeout(E,a),w(v)}return g===void 0&&(g=setTimeout(E,a)),m}return O.cancel=N,O.flush=k,O}return Q=l,Q}var Ge=We();const He=Fe(Ge),Ke=e=>e.filter(r=>r.level==="top_category").map(r=>{var f;const s=e.filter(a=>a.level==="sub_category"&&a.parentId===r.id),o=((f=r.name)==null?void 0:f.toLowerCase())??"";if(s.length===0)return{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`,subCategories:[{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`}]};const l=s.map(a=>({id:a.id,name:a.name,href:`/catalog/${o.toLowerCase()}/${a.name.toLowerCase()}`}));return{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`,subCategories:l}});function ee(e,t){const r=e.find(c=>c.level==="top_category"&&c.id===t);if(!r||!r.name)return null;const s=r.name.toLowerCase();return s||r.name||null}function Ye(e,t){const r=e.find(s=>s.level==="sub_category"&&s.id===t);return!r||!r.name?null:r.name||null}function Xe(e,t){const s=Ke(e).find(c=>c.id===t);return(s==null?void 0:s.subCategories)||[]}function te({href:e,children:t,disabled:r=!1,variant:s="default"}){return n.jsx(R,{asChild:!r,variant:s,className:"whitespace-nowrap uppercase hover:underline",disabled:r,children:r?n.jsx(n.Fragment,{children:t}):n.jsx(ke,{to:e,children:t})})}function G(){var h,d;const{dictionary:e}=A(),[t]=z(),r=t.get("topCategory"),s=t.get("subCategory"),c=t.get("gender")||"",o=Se[c]??c,l=(e==null?void 0:e.categories)||[],f=r?l.find(m=>m.level==="top_category"&&String(m.id)===r)??null:null,a=s?l.find(m=>m.level==="sub_category"&&String(m.id)===s&&(f?m.parentId===f.id:!0))??null:null,i=f?((h=f.name)==null?void 0:h.toLowerCase())??"":"",u=a?((d=a.name)==null?void 0:d.toLowerCase())??"":"";return{gender:o||"",categoryName:i,subCategoryName:u,topCategory:f??void 0,subCategory:a??void 0}}function ne(e,t){const r=new URLSearchParams(e);t.topCategory!==void 0&&(t.topCategory?r.set("topCategory",t.topCategory):r.delete("topCategory")),t.subCategory!==void 0&&(t.subCategory?r.set("subCategory",t.subCategory):r.delete("subCategory")),t.gender!==void 0&&(t.gender?r.set("gender",t.gender):r.delete("gender"));const s=r.toString();return s?`${D.product}?${s}`:D.product}const ge="SORT_FACTOR_CREATED_AT",pe="ORDER_FACTOR_DESC";function Ze(e){return e?B[e]?B[e]:e.startsWith("SORT_FACTOR_")&&e!=="SORT_FACTOR_UNKNOWN"?e:ge:ge}function Je(e){return e?q[e]?q[e]:e.startsWith("ORDER_FACTOR_")&&e!=="ORDER_FACTOR_UNKNOWN"?e:pe:pe}function Qe(e){return!!(e&&e.startsWith("GENDER_ENUM_")&&e!=="GENDER_ENUM_UNKNOWN"&&e!=="all")}function je({sort:e,order:t,topCategory:r,subCategory:s,type:c,gender:o,sizes:l,tag:f,color:a,from:i,to:u,sale:h,preorder:d,hidden:m,collections:g,currency:v}){const C=Ze(e),y=Je(t),j=o&&ie[o.toLowerCase()]?ie[o.toLowerCase()]:o;return{sortFactors:[C],orderFactor:y,filterConditions:{from:i||void 0,to:u||void 0,gender:Qe(j)?[j]:void 0,color:a||void 0,topCategoryIds:r?r.split(",").map(p=>parseInt(p)):void 0,subCategoryIds:s?s.split(",").map(p=>parseInt(p)):void 0,typeIds:c?c.split(",").map(p=>parseInt(p)):void 0,sizesIds:l?l.split(",").map(p=>parseInt(p)):void 0,byTag:f||void 0,preorder:d?d==="true":void 0,onSale:h?h==="true":void 0,collections:g?g.split(","):void 0,currency:v||void 0},showHidden:m!=="false"}}function et(){var l,f;const[e]=z(),{gender:t}=G(),r=e.get("gender")||void 0,{dictionary:s}=A(),c=(s==null?void 0:s.categories)||[],o=(f=(l=s==null?void 0:s.categories)==null?void 0:l.filter(a=>a.level==="top_category"&&a.name!=="objects"))==null?void 0:f.filter(a=>{if(t==="men"){const i=ee(c,a.id||0);return(i==null?void 0:i.toLowerCase())!=="dresses"}return!0}).sort((a,i)=>(a.id||0)-(i.id||0));return n.jsx("div",{className:"flex items-center gap-2",children:o==null?void 0:o.map((a,i)=>{var m;const u=ee(c,a.id||0),h=((m=a.name)==null?void 0:m.toLowerCase())||"";if(!u)return null;const d=ne(e,{topCategory:String(a.id),subCategory:"",gender:r});return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(te,{href:d,disabled:ye(a,t),children:h||""}),i<o.length-1&&n.jsx(S,{children:"/"})]},a.id)})})}function tt(e,t){return t==="men"?e.filter(r=>{var s;return!["swimwear_w","bralettes","heels"].includes(((s=r.name)==null?void 0:s.toLowerCase())??"")}):e.filter(r=>{var s;return((s=r.name)==null?void 0:s.toLowerCase())!=="swimwear_m"})}function ye(e,t){return e?t?t==="men"?!e.countMen:!e.countWomen:!e.countMen&&!e.countWomen:!0}function nt(){const{dictionary:e}=A(),[t]=z(),{gender:r,categoryName:s,subCategoryName:c,topCategory:o,subCategory:l}=G(),f=t.get("gender")||void 0,a=(e==null?void 0:e.categories)||[],i=Xe(a,(o==null?void 0:o.id)||0),u=tt(i,r);if(!s&&!(o!=null&&o.id))return n.jsx(et,{});const h=o?ee(a,o.id||0):s,d=(l==null?void 0:l.id)!=null,m=ne(t,{topCategory:d&&(o==null?void 0:o.id)!=null?String(o.id):"",subCategory:"",gender:f});return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(te,{href:m,children:h||s||""}),!!u.length&&n.jsx(S,{children:"/"}),u.map((g,v)=>{var w;const C=a.find(x=>x.id===g.id),y=ye(C,r),j=Ye(a,g.id),p=ne(t,{topCategory:(o==null?void 0:o.id)!=null?String(o.id):"",subCategory:String(g.id),gender:f});return n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(te,{href:p,variant:c===((w=g.name)==null?void 0:w.toLowerCase())?"underline":"default",disabled:y,children:j||""}),v<u.length-1&&n.jsx(S,{children:"/"})]},g.id)})]})}function Ne({cover:e,color:t="dark",disablePointerEvents:r=!0,onClick:s}){return n.jsx("div",{className:W("inset-0 z-20 h-screen",{"pointer-events-none":r,"bg-overlay":t==="dark","bg-white/50":t==="light","bg-highlightColor mix-blend-screen":t==="highlight",fixed:e==="screen","absolute h-full":e==="container"}),onClick:s,"aria-hidden":"true"})}function I(e,t=!1){const[r]=z(),s=ze().pathname,c=re();function o(a,i){const u=new URLSearchParams(r);a?Array.isArray(a)?a.length>0?u.set(e,a.join(",")):u.delete(e):u.set(e,a):u.delete(e),i&&Object.entries(i).forEach(([h,d])=>{d?u.set(h,d):u.delete(h)}),c(`${s}?${u.toString()}`,{replace:!0})}const l=r.get(e);return{defaultValue:t?(l==null?void 0:l.split(","))||[]:l||"",handleFilterChange:o}}function st(){const{defaultValue:e,handleFilterChange:t}=I("color"),r=Oe.map(s=>({value:s.name.toLowerCase(),label:s.name}));return n.jsxs("div",{className:"space-y-2",children:[n.jsx(S,{variant:"uppercase",size:"small",children:"color"}),n.jsx(xe,{label:"color",options:r,value:e||"",onChange:s=>t(s),showAll:!0})]})}const rt=Object.entries(we).map(([e,t])=>({value:e,label:`${e} ${t}`}));function at(){const{defaultValue:e,handleFilterChange:t}=I("from"),{defaultValue:r,handleFilterChange:s}=I("to"),{defaultValue:c,handleFilterChange:o}=I("currency");return n.jsxs("div",{className:"flex",children:[n.jsx(be,{name:"currency",placeholder:"currency",items:rt,value:c||"",onValueChange:l=>o(l)}),n.jsxs("div",{className:"flex gap-3 w-full",children:[n.jsx(oe,{type:"number",placeholder:"price from",name:"from",value:e||"",onChange:l=>t(l.target.value)}),n.jsx(oe,{type:"number",placeholder:"price to",name:"to",value:r||"",onChange:l=>s(l.target.value)})]})]})}function it(){const{defaultValue:e,handleFilterChange:t}=I("gender");return n.jsxs("div",{className:"space-y-2",children:[n.jsx(S,{variant:"uppercase",size:"small",children:"gender"}),n.jsx(xe,{label:"gender",value:e||"all",options:Le,onChange:t,showAll:!0})]})}function ot(){const{defaultValue:e,handleFilterChange:t}=I("preorder"),{defaultValue:r,handleFilterChange:s}=I("hidden"),{defaultValue:c,handleFilterChange:o}=I("sale");return n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(H,{name:"preorder",label:"preorder",checked:e==="true",onChange:l=>t(l.toString())}),n.jsx(S,{variant:"uppercase",size:"small",children:"preorder"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(H,{name:"hidden",label:"hidden",checked:r!=="false",onChange:l=>s(l?"true":"false")}),n.jsx(S,{variant:"uppercase",size:"small",children:"show hidden"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(H,{name:"sale",label:"sale",checked:c==="true",onChange:l=>o(l.toString())}),n.jsx(S,{variant:"uppercase",size:"small",children:"sale"})]})]})}const lt=Pe.map(e=>({value:String(e.value),label:e.label}));function ct(){const{defaultValue:e,handleFilterChange:t}=I("limit"),r=e||String($);return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(S,{variant:"uppercase",size:"small",className:"w-full",children:"show latest"}),n.jsx(be,{name:"limit",placeholder:"quantity",items:lt,value:r,onValueChange:s=>t(s)})]})}function dt(e){const t=e.match(/_(\d+)(?:ta|bo)_[mf]$/);return t?t[1]:e}function ut(e){return"id"in e?String(e.id):e.name||""}function V(e){var t;return((t=e.name)==null?void 0:t.toLowerCase())||""}const mt={numeric:/^\d+(\.\d+)?$/,bottoms:/_\d+bo_[mf]$/,tailored:/_\d+ta_[mf]$/};function ft({selectedValues:e,values:t,title:r,showSeparated:s=!1,gender:c,handleFilterChange:o}){const[l,f]=T.useState(null),a=(x,_)=>mt[_].test(x),i=x=>!a(x,"numeric")&&!a(x,"bottoms")&&!a(x,"tailored"),u=t.filter(x=>i(V(x))),h=t.filter(x=>a(V(x),"numeric")),d=t.filter(x=>a(V(x),"bottoms")),m=t.filter(x=>a(V(x),"tailored")),g=s?u.length>0:!0,v=s?h.length>0:!1,C=s?d.length>0:!1,y=s?m.length>0:!1,j=async x=>{f(x),await new Promise(_=>setTimeout(_,500)),o(x),f(null)},p=x=>{const _=ut(x),L=e.includes(_),E=l===_,P=x.countMen||0,N=x.countWomen||0,k=c==="men"?P>0:c==="women"?N>0:P>0||N>0,O=dt(V(x));return n.jsx(R,{onClick:()=>j(_),loading:E,loadingReverse:L,loadingType:"overlay",disabled:E||!k,className:W("block border border-transparent uppercase md:hover:border-textColor",{"border-textColor":L}),children:O},_)};if(!s)return n.jsxs("div",{className:"space-y-6",children:[r&&n.jsx(S,{variant:"uppercase",children:r}),n.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:t.map(p)})]});const w=[g,v,C,y].filter(Boolean).length>1;return n.jsxs("div",{className:W("grid",{"gap-y-7":w}),children:[g&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(S,{variant:"uppercase",children:r||"size"}),n.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:u.map(p)})]}),y&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(S,{variant:"uppercase",children:"tailored"}),n.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:m.map(p)})]}),C&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(S,{variant:"uppercase",children:"bottoms"}),n.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:d.map(p)})]}),v&&n.jsxs("div",{className:"space-y-6",children:[n.jsx(S,{variant:"uppercase",children:"shoe size"}),n.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:h.map(p)})]})]})}function ht({filterKey:e,multiSelect:t=!1}){const{dictionary:r}=A(),{defaultValue:s,handleFilterChange:c}=I(e),o=(r==null?void 0:r.sizes)||[],l=Array.isArray(s)?s:s?s.split(","):[];l.length===0?[]:l.map(d=>o.find(m=>String(m.id)===d)).filter(Boolean);const a=l.filter(d=>o.some(m=>String(m.id)===d)),[i,u]=T.useState(a);return T.useEffect(()=>{s||u([])},[s]),{selectedValues:i,handleToggle:async d=>{let m;t?m=i.includes(d)?i.filter(v=>v!==d):[...i,d]:m=i.includes(d)?[]:[d],u(m);const g=m.length>0?m.join(","):void 0;c(g)}}}function gt(){var h;const{dictionary:e}=A(),{topCategory:t}=G(),r=(e==null?void 0:e.sizes)||[],s=e==null?void 0:e.categories,c=t!=null&&t.id?s==null?void 0:s.find(d=>d.id===t.id):void 0,o=(c==null?void 0:c.name)||"",l=o.toLowerCase().includes("shoes"),f=o.toLowerCase().includes("bottoms"),a=o.toLowerCase().includes("tailored"),i=r.filter(d=>{var y;if(!(t!=null&&t.id))return!0;const m=((y=d.name)==null?void 0:y.toLowerCase())||"",g=/^\d+(\.\d+)?$/.test(m),v=/_\d+bo_[mf]$/.test(m),C=/_\d+ta_[mf]$/.test(m);return l?g:f?v:a?C:!g&&!v&&!C});return{sizeOptions:(h=i==null?void 0:i.sort((d,m)=>(d.id??0)-(m.id??0)))==null?void 0:h.map(d=>({...d,name:d.name||""})),filteredSizes:i}}function pt({gender:e}){const{sizeOptions:t}=gt(),{selectedValues:r,handleToggle:s}=ht({filterKey:"size",multiSelect:!0});return n.jsx(ft,{selectedValues:r,handleFilterChange:s,values:t||[],showSeparated:!0,gender:e})}function xt(e,t){const r=t.sale,s=e.label?`${e.label}: `:"";return`${r?r?"sale: ":"":s}${t.name}`}function U(e,t){return Object.keys(t).find(r=>t[r]===e)||""}function vt(){const{defaultValue:e,handleFilterChange:t}=I("sort"),{defaultValue:r}=I("order"),{defaultValue:s}=I("sale");return n.jsx("div",{className:"mr-16 space-y-2",children:Object.entries(Te).flatMap(([c,o])=>o.orderFactors.map((l,f)=>{const a=e===U(c,B),i=r===U(l.factor,q),u=l.sale?s==="true":!s,h=a&&i&&u;return n.jsx(R,{onClick:()=>{h?t(void 0,{order:"",sale:""}):t(U(c,B),{order:U(l.factor,q),sale:l.sale?"true":""})},className:W("block",{underline:h}),children:xt(o,l)},`${c}-${f}`)}))})}function Ct({isOpen:e,toggleModal:t}){const{gender:r}=G();return n.jsx("div",{className:"z-50 w-full",children:e&&n.jsxs("div",{className:"hidden lg:block",children:[n.jsx(Ne,{cover:"screen",onClick:t,disablePointerEvents:!1}),n.jsx("div",{className:"fixed inset-y-2 right-2 z-30 w-[445px] border border-textInactiveColor bg-bgColor p-2.5 text-textColor",children:n.jsxs("div",{className:"flex h-full flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(S,{variant:"uppercase",children:"filter"}),n.jsx(R,{variant:"simple",onClick:t,children:"[x]"})]}),n.jsxs("div",{className:"h-full space-y-10 overflow-y-scroll pt-6",children:[n.jsxs("div",{className:"space-y-6",children:[n.jsx(S,{variant:"uppercase",children:"sort by"}),n.jsx(vt,{})]}),n.jsx(ot,{}),n.jsx(ct,{}),n.jsx(it,{}),n.jsx(st,{}),n.jsx(at,{}),n.jsx(pt,{gender:r})]}),n.jsxs("div",{className:"flex items-center justify-end gap-2 bg-bgColor",children:[n.jsx(R,{className:"w-1/2 uppercase",size:"lg",onClick:()=>{},children:"clear all"}),n.jsx(R,{className:"w-1/2 uppercase",size:"lg",onClick:()=>t(),children:"show"})]})]})})]})})}function bt({product:e,refresh:t}){var d,m,g,v,C,y,j,p,w,x,_,L,E,P;const r=(v=(g=(m=(d=e.productDisplay)==null?void 0:d.thumbnail)==null?void 0:m.media)==null?void 0:g.thumbnail)==null?void 0:v.mediaUrl,s=(j=(y=(C=e.productDisplay)==null?void 0:C.productBody)==null?void 0:y.productBodyInsert)==null?void 0:j.hidden,c=`[${e.id}] ${(x=(w=(p=e.productDisplay)==null?void 0:p.productBody)==null?void 0:w.productBodyInsert)==null?void 0:x.brand} ${(P=(E=(L=(_=e.productDisplay)==null?void 0:_.productBody)==null?void 0:L.translations)==null?void 0:E[0])==null?void 0:P.name}`,{showMessage:o}=ve(),[l,f]=T.useState(void 0),a=re();async function i(N,k){if(k.stopPropagation(),l===N)try{await se.DeleteProductByID({id:N}),o("PRODUCT WAS SUCCESSFULLY DELETED","success"),f(void 0),t(N)}catch(O){const b=O instanceof Error?O.message:"Failed to delete product";o(b,"error")}else f(N)}const u=N=>{a(`${D.product}/${N}`,{replace:!0})},h=(N,k)=>{k.stopPropagation(),confirm("Are you sure you want to copy this product?")&&a(`${D.copyProduct}/${N}`)};return n.jsxs("div",{className:"space-y-1",onClick:()=>u(e.id),children:[n.jsxs("div",{className:"relative w-full h-full group",children:[n.jsx(_e,{src:r||"",alt:"prod item",type:le(r)?"video":"image",controls:le(r)}),n.jsx(R,{onClick:N=>i(e.id,N),className:"absolute top-0 right-0 p-1 md:group-hover:block md:hidden block",children:l===e.id?n.jsx(Ie,{}):n.jsx(Ee,{})}),n.jsx(R,{size:"lg",className:"absolute bottom-0 left-0",onClick:N=>h(e.id,N),children:"copy"}),s&&n.jsx(Ne,{cover:"container"})]}),n.jsx(S,{className:"w-full break-words",variant:"underLineWithColor",size:"small",children:c})]})}function jt({products:e,refresh:t}){return n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 2xl:grid-cols-6 gap-4",children:e.map(r=>n.jsx("div",{children:n.jsx(bt,{product:r,refresh:t})},r.id))})}function yt({firstItems:e}){const[t]=z(),[r,s]=T.useState(e),[c,o]=T.useState(!1),{showMessage:l}=ve(),{ref:f,inView:a}=Re(),i=T.useRef(2),u=T.useRef(!0),[h,d]=T.useState(!0),m=T.useRef(!1);T.useEffect(()=>{s(e);const p=t.has("limit");u.current=!p,d(!p),i.current=2,o(!1)},[e,t]);const g=Object.fromEntries(t.entries()),v=g.limit?Math.max(1,parseInt(g.limit,10)||$):$,C=t.has("limit"),y=async()=>{if(!u.current||c){console.log("Skipping load:",{hasMore:u.current,isLoading:c});return}o(!0);try{const p=(i.current-1)*v,x=(await se.GetProductsPaged({limit:v,offset:p,...je(g)})).products||[];(!x.length||x.length<v)&&(u.current=!1,d(!1)),i.current+=1,s(_=>[..._,...x])}catch(p){const w=p instanceof Error?p.message:"Failed to fetch more products";l(w,"error")}finally{o(!1)}};T.useEffect(()=>{if(C)return;const p=a&&!m.current;m.current=a,e.length!==0&&p&&u.current&&!c&&y()},[a,t,e.length,C]);function j(p){p&&s(r.filter(w=>w.id!==p))}return n.jsxs("div",{children:[n.jsx(jt,{products:r,refresh:j}),h&&n.jsx("div",{ref:f,className:"text-center text-xl",style:{minHeight:"100px"},children:"loading..."})]})}function Rt(){const[e]=z(),[t,r]=T.useState([]),[s,c]=T.useState(!1);function o(){c(!s)}const l=Object.fromEntries(e.entries()),f=re(),a={...l,sizes:l.sizes??l.size,hidden:l.hidden??"true"},i=T.useCallback(He(async d=>{const m=d.limit?Math.max(1,parseInt(d.limit,10)||$):$,g=await se.GetProductsPaged({limit:m,offset:0,...je(d)});r(g.products||[])},1e3),[]),u=e.toString();T.useEffect(()=>(i(a),()=>i.cancel()),[u,i]);const h=()=>{f(`${D.addProduct}`)};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col grid gap-10 pb-20",children:[n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsx(nt,{}),n.jsx(R,{variant:"simple",className:"uppercase",onClick:o,children:"filter +"})]}),n.jsx(Ct,{isOpen:s,toggleModal:o}),n.jsx(yt,{firstItems:t})]}),n.jsx(R,{className:"fixed bottom-4 right-4 z-20",size:"lg",onClick:h,children:"create new"})]})}export{Rt as default};
