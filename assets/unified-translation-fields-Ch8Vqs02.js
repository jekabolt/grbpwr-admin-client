import{j as r}from"./mui--1QQx6Xz.js";import{u as T,x as V,E as I,a7 as A,T as S,z as D}from"./index-pGCpQgmF.js";import{r as g}from"./vendor-BqCw_tH9.js";function O({fieldPrefix:s,fields:l,editMode:j=!0}){const{control:w,watch:h,setValue:i,formState:{errors:$}}=T(),{replace:p}=V({control:w,name:s}),o=h(s)||[],[u,y]=g.useState(I[0].id),[E,v]=g.useState({}),b=I.find(e=>e.id===u),m=o.findIndex(e=>(e==null?void 0:e.languageId)===u),d=m>=0?m:o.length;g.useEffect(()=>{if(o.length===0){const e=I.map(n=>{const a={languageId:n.id};return l.forEach(t=>{a[t.name]=""}),a});p(e)}},[o.length,p]),g.useEffect(()=>{if(m<0&&o.length>0){const e={languageId:u};l.forEach(a=>{e[a.name]=""});const n=[...o,e];p(n)}else m>=0&&i(`${s}.${m}.languageId`,u,{shouldDirty:!0})},[u,m,o.length,p,i,s]),g.useEffect(()=>{var c;const e=s.split(".");let n=$;for(const x of e)if(n=n==null?void 0:n[x],!n)return;if(!Array.isArray(n)||!n.length||!o.length)return;const a=n.findIndex(x=>x&&l.some(L=>x[L.name])),t=(c=o[a])==null?void 0:c.languageId;a!==-1&&typeof t=="number"&&y(t)},[$,s,l,o]),g.useEffect(()=>{const e={};l.forEach(n=>{const a=`${s}.${d}.${n.name}`;e[n.name]=h(a)||""}),v(e)},[u,d,l,s,h]);const f=(e,n)=>{e.preventDefault(),l.forEach(a=>{const t=`${s}.${d}.${a.name}`,c=E[a.name];c!==void 0&&i(t,c,{shouldDirty:!0})}),y(n)},N=(e,n)=>{v(t=>({...t,[e]:n}));const a=`${s}.${d}.${e}`;i(a,n,{shouldDirty:!0})},C=e=>{const n=o.findIndex(a=>(a==null?void 0:a.languageId)===e);return n<0?!1:l.some(a=>{const t=h(`${s}.${n}.${a.name}`);return t&&t.trim().length>0})},F=e=>{const a=`${s}.${d}.${e}`.split(".");let t=$;for(const c of a){if(!t)return null;t=t[c]}return t==null?void 0:t.message};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(A,{selectedLanguageId:u,isLanguageFilled:C,onLanguageChange:f}),r.jsx("div",{className:"space-y-4",children:l.map(e=>{const n=E[e.name]||"",a=e.placeholder||`enter ${e.label.toLowerCase()} in ${b==null?void 0:b.name}`,t=F(e.name);return e.type==="textarea"?r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:e.label}),r.jsx("textarea",{value:n,onChange:c=>N(e.name,c.target.value),placeholder:a,className:`w-full border ${t?"border-red-500":"border-text"} leading-4 bg-transparent resize-none min-h-[100px] focus:outline-none p-2`,rows:e.rows||4,readOnly:!j}),t&&r.jsx("p",{className:"text-sm font-medium text-red-500",children:t})]},e.name):r.jsxs("div",{className:"space-y-2",children:[r.jsx(S,{component:"label",children:e.label}),r.jsx("div",{className:`border-b ${t?"border-red-500":"border-textColor"}`,children:r.jsx(D,{value:n,onChange:c=>N(e.name,c.target.value),placeholder:a,className:"w-full border-none leading-4 bg-transparent",readOnly:!j})}),t&&r.jsx("p",{className:"text-sm font-medium text-red-500",children:t})]},e.name)})})]})}export{O as U};
