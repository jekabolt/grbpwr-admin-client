import{j as r}from"./mui-D9Bk7yoK.js";import{u as f,x as A,L as j,ab as S,T as $,G as D}from"./index-FnTyGfVD.js";import{r as h}from"./vendor-DljJgkTU.js";function z({fieldPrefix:s,fields:l,editMode:y=!0}){const{control:C,watch:d,setValue:i,formState:{errors:b}}=f(),{replace:p}=A({control:C,name:s}),o=d(s)||[],[u,E]=h.useState(j[0].id),[v,w]=h.useState({}),I=j.find(n=>n.id===u),g=o.findIndex(n=>(n==null?void 0:n.languageId)===u),m=g>=0?g:o.length;h.useEffect(()=>{if(o.length===0){const n=j.map(e=>{const a={languageId:e.id};return l.forEach(t=>{a[t.name]=""}),a});p(n)}},[o.length,p]),h.useEffect(()=>{if(g<0&&o.length>0){const n={languageId:u};l.forEach(a=>{n[a.name]=""});const e=[...o,n];p(e)}else g>=0&&i(`${s}.${g}.languageId`,u,{shouldDirty:!0})},[u,g,o.length,p,i,s]),h.useEffect(()=>{var c;const n=s.split(".");let e=b;for(const x of n)if(e=e==null?void 0:e[x],!e)return;if(!Array.isArray(e)||!e.length||!o.length)return;const a=e.findIndex(x=>x&&l.some(V=>x[V.name])),t=(c=o[a])==null?void 0:c.languageId;a!==-1&&typeof t=="number"&&E(t)},[b,s,l,o]),h.useEffect(()=>{const n={};l.forEach(e=>{const a=`${s}.${m}.${e.name}`;n[e.name]=d(a)||""}),w(n)},[u,m,l,s,d]);const L=(n,e)=>{n.preventDefault(),l.forEach(a=>{const t=`${s}.${m}.${a.name}`,c=v[a.name];c!==void 0&&i(t,c,{shouldDirty:!0})}),E(e)},N=(n,e)=>{w(t=>({...t,[n]:e}));const a=`${s}.${m}.${n}`;i(a,e,{shouldDirty:!0})},F=n=>{const e=o.findIndex(a=>(a==null?void 0:a.languageId)===n);return e<0?!1:l.some(a=>{const t=d(`${s}.${e}.${a.name}`);return t&&t.trim().length>0})},T=n=>{const a=`${s}.${m}.${n}`.split(".");let t=b;for(const c of a){if(!t)return null;t=t[c]}return t==null?void 0:t.message};return r.jsxs("div",{className:"space-y-3",children:[r.jsx(S,{selectedLanguageId:u,isLanguageFilled:F,onLanguageChange:L}),r.jsx("div",{className:"space-y-4",children:l.map(n=>{const e=v[n.name]||"",a=n.placeholder||`enter ${n.label.toLowerCase()} in ${I==null?void 0:I.name}`,t=T(n.name);return n.type==="textarea"?r.jsxs("div",{className:"space-y-2",children:[r.jsx($,{component:"label",children:n.label}),r.jsx("textarea",{value:e,onChange:c=>N(n.name,c.target.value),placeholder:a,className:`w-full border ${t?"border-red-500":"border-text"} leading-4 bg-transparent resize-none min-h-[100px] focus:outline-none p-2`,rows:n.rows||4,readOnly:!y}),t&&r.jsx($,{className:"text-red-500",children:t})]},n.name):r.jsxs("div",{className:"space-y-2",children:[r.jsx($,{component:"label",children:n.label}),r.jsx("div",{className:`border-b ${t?"border-red-500":"border-textColor"}`,children:r.jsx(D,{value:e,onChange:c=>N(n.name,c.target.value),placeholder:a,className:"w-full border-none leading-4 bg-transparent",readOnly:!y})}),t&&r.jsx($,{className:"text-red-500",children:t})]},n.name)})})]})}export{z as U};
