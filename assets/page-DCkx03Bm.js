import{j as t}from"./mui--1QQx6Xz.js";import{B as R,a as A,a8 as Ne,a9 as ie,aa as B,ab as q,R as M,T as S,c as W,S as xe,z as oe,G as Se,ac as we,t as Te,d as _e,ad as le,A as Ie,ae as Ee,b as se,af as Re}from"./index-BT0eTlOv.js";import{c as Oe,g as Le,a as Pe,D as $}from"./filter-Ct7KBysK.js";import{g as Fe,L as ke,k as z,j as ze,u as re,r as w}from"./vendor-BqCw_tH9.js";import{b as Ve,r as De,d as Me,a as ve}from"./isObjectLike-Cfdbo5Gm.js";import{S as Ce}from"./select-Dt907D3I.js";import{C as H}from"./checkbox-DQKxI2UC.js";var K,ce;function $e(){if(ce)return K;ce=1;var e=Ve(),n=function(){return e.Date.now()};return K=n,K}var Y,de;function Ae(){if(de)return Y;de=1;var e=/\s/;function n(r){for(var s=r.length;s--&&e.test(r.charAt(s)););return s}return Y=n,Y}var X,ue;function Ue(){if(ue)return X;ue=1;var e=Ae(),n=/^\s+/;function r(s){return s&&s.slice(0,e(s)+1).replace(n,"")}return X=r,X}var Z,me;function Be(){if(me)return Z;me=1;var e=De(),n=Me(),r="[object Symbol]";function s(c){return typeof c=="symbol"||n(c)&&e(c)==r}return Z=s,Z}var J,fe;function qe(){if(fe)return J;fe=1;var e=Ue(),n=ve(),r=Be(),s=NaN,c=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;function i(a){if(typeof a=="number")return a;if(r(a))return s;if(n(a)){var m=typeof a.valueOf=="function"?a.valueOf():a;a=n(m)?m+"":m}if(typeof a!="string")return a===0?a:+a;a=e(a);var h=o.test(a);return h||l.test(a)?f(a.slice(2),h?2:8):c.test(a)?s:+a}return J=i,J}var Q,he;function We(){if(he)return Q;he=1;var e=ve(),n=$e(),r=qe(),s="Expected a function",c=Math.max,o=Math.min;function l(f,i,a){var m,h,d,u,g,v,b=0,y=!1,x=!1,C=!0;if(typeof f!="function")throw new TypeError(s);i=r(i)||0,e(a)&&(y=!!a.leading,x="maxWait"in a,d=x?c(r(a.maxWait)||0,i):d,C="trailing"in a?!!a.trailing:C);function T(j){var P=m,V=h;return m=h=void 0,b=j,u=f.apply(V,P),u}function p(j){return b=j,g=setTimeout(E,i),y?T(j):u}function _(j){var P=j-v,V=j-b,ae=i-P;return x?o(ae,d-V):ae}function O(j){var P=j-v,V=j-b;return v===void 0||P>=i||P<0||x&&V>=d}function E(){var j=n();if(O(j))return L(j);g=setTimeout(E,_(j))}function L(j){return g=void 0,C&&m?T(j):(m=h=void 0,u)}function N(){g!==void 0&&clearTimeout(g),b=0,m=v=h=g=void 0}function F(){return g===void 0?u:L(n())}function k(){var j=n(),P=O(j);if(m=arguments,h=this,v=j,P){if(g===void 0)return p(v);if(x)return clearTimeout(g),g=setTimeout(E,i),T(v)}return g===void 0&&(g=setTimeout(E,i)),u}return k.cancel=N,k.flush=F,k}return Q=l,Q}var Ge=We();const He=Fe(Ge),Ke=e=>e.filter(r=>r.level==="top_category").map(r=>{var f;const s=e.filter(i=>i.level==="sub_category"&&i.parentId===r.id),o=((f=r.name)==null?void 0:f.toLowerCase())??"";if(s.length===0)return{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`,subCategories:[{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`}]};const l=s.map(i=>({id:i.id,name:i.name,href:`/catalog/${o.toLowerCase()}/${i.name.toLowerCase()}`}));return{id:r.id,name:o,href:`/catalog/${o.toLowerCase()}`,subCategories:l}});function ee(e,n){const r=e.find(c=>c.level==="top_category"&&c.id===n);if(!r||!r.name)return null;const s=r.name.toLowerCase();return s||r.name||null}function Ye(e,n){const r=e.find(s=>s.level==="sub_category"&&s.id===n);return!r||!r.name?null:r.name||null}function Xe(e,n){const s=Ke(e).find(c=>c.id===n);return(s==null?void 0:s.subCategories)||[]}function ne({href:e,children:n,disabled:r=!1,variant:s="default"}){return t.jsx(R,{asChild:!r,variant:s,className:"whitespace-nowrap uppercase hover:underline",disabled:r,children:r?t.jsx(t.Fragment,{children:n}):t.jsx(ke,{to:e,children:n})})}function G(){var h,d;const{dictionary:e}=A(),[n]=z(),r=n.get("topCategory"),s=n.get("subCategory"),c=n.get("gender")||"",o=Ne[c]??c,l=(e==null?void 0:e.categories)||[],f=r?l.find(u=>u.level==="top_category"&&String(u.id)===r)??null:null,i=s?l.find(u=>u.level==="sub_category"&&String(u.id)===s&&(f?u.parentId===f.id:!0))??null:null,a=f?((h=f.name)==null?void 0:h.toLowerCase())??"":"",m=i?((d=i.name)==null?void 0:d.toLowerCase())??"":"";return{gender:o||"",categoryName:a,subCategoryName:m,topCategory:f??void 0,subCategory:i??void 0}}function te(e,n){const r=new URLSearchParams(e);n.topCategory!==void 0&&(n.topCategory?r.set("topCategory",n.topCategory):r.delete("topCategory")),n.subCategory!==void 0&&(n.subCategory?r.set("subCategory",n.subCategory):r.delete("subCategory")),n.gender!==void 0&&(n.gender?r.set("gender",n.gender):r.delete("gender"));const s=r.toString();return s?`${M.product}?${s}`:M.product}const ge="SORT_FACTOR_CREATED_AT",pe="ORDER_FACTOR_DESC";function Ze(e){return e?B[e]?B[e]:e.startsWith("SORT_FACTOR_")&&e!=="SORT_FACTOR_UNKNOWN"?e:ge:ge}function Je(e){return e?q[e]?q[e]:e.startsWith("ORDER_FACTOR_")&&e!=="ORDER_FACTOR_UNKNOWN"?e:pe:pe}function Qe(e){return!!(e&&e.startsWith("GENDER_ENUM_")&&e!=="GENDER_ENUM_UNKNOWN"&&e!=="all")}function be({sort:e,order:n,topCategory:r,subCategory:s,type:c,gender:o,sizes:l,tag:f,color:i,from:a,to:m,sale:h,preorder:d,hidden:u,collections:g,currency:v}){const b=Ze(e),y=Je(n),x=o&&ie[o.toLowerCase()]?ie[o.toLowerCase()]:o;return{sortFactors:[b],orderFactor:y,filterConditions:{from:a||void 0,to:m||void 0,gender:Qe(x)?[x]:void 0,color:i||void 0,topCategoryIds:r?r.split(",").map(C=>parseInt(C)):void 0,subCategoryIds:s?s.split(",").map(C=>parseInt(C)):void 0,typeIds:c?c.split(",").map(C=>parseInt(C)):void 0,sizesIds:l?l.split(",").map(C=>parseInt(C)):void 0,byTag:f||void 0,preorder:d?d==="true":void 0,onSale:h?h==="true":void 0,collections:g?g.split(","):void 0,currency:v||void 0},showHidden:u!=="false"}}function en(){var l,f;const[e]=z(),{gender:n}=G(),r=e.get("gender")||void 0,{dictionary:s}=A(),c=(s==null?void 0:s.categories)||[],o=(f=(l=s==null?void 0:s.categories)==null?void 0:l.filter(i=>i.level==="top_category"&&i.name!=="objects"))==null?void 0:f.filter(i=>{if(n==="men"){const a=ee(c,i.id||0);return(a==null?void 0:a.toLowerCase())!=="dresses"}return!0}).sort((i,a)=>(i.id||0)-(a.id||0));return t.jsx("div",{className:"flex items-center gap-2",children:o==null?void 0:o.map((i,a)=>{var u;const m=ee(c,i.id||0),h=((u=i.name)==null?void 0:u.toLowerCase())||"";if(!m)return null;const d=te(e,{topCategory:String(i.id),subCategory:"",gender:r});return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ne,{href:d,disabled:je(i,n),children:h||""}),a<o.length-1&&t.jsx(S,{children:"/"})]},i.id)})})}function nn(e,n){return n==="men"?e.filter(r=>{var s;return!["swimwear_w","bralettes","heels"].includes(((s=r.name)==null?void 0:s.toLowerCase())??"")}):e.filter(r=>{var s;return((s=r.name)==null?void 0:s.toLowerCase())!=="swimwear_m"})}function je(e,n){return e?n?n==="men"?!e.countMen:!e.countWomen:!e.countMen&&!e.countWomen:!0}function tn(){const{dictionary:e}=A(),[n]=z(),{gender:r,categoryName:s,subCategoryName:c,topCategory:o,subCategory:l}=G(),f=n.get("gender")||void 0,i=(e==null?void 0:e.categories)||[],a=Xe(i,(o==null?void 0:o.id)||0),m=nn(a,r);if(!s&&!(o!=null&&o.id))return t.jsx(en,{});const h=o?ee(i,o.id||0):s,d=(l==null?void 0:l.id)!=null,u=te(n,{topCategory:d&&(o==null?void 0:o.id)!=null?String(o.id):"",subCategory:"",gender:f});return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ne,{href:u,children:h||s||""}),!!m.length&&t.jsx(S,{children:"/"}),m.map((g,v)=>{var T;const b=i.find(p=>p.id===g.id),y=je(b,r),x=Ye(i,g.id),C=te(n,{topCategory:(o==null?void 0:o.id)!=null?String(o.id):"",subCategory:String(g.id),gender:f});return t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ne,{href:C,variant:c===((T=g.name)==null?void 0:T.toLowerCase())?"underline":"default",disabled:y,children:x||""}),v<m.length-1&&t.jsx(S,{children:"/"})]},g.id)})]})}function ye({cover:e,color:n="dark",disablePointerEvents:r=!0,onClick:s}){return t.jsx("div",{className:W("inset-0 z-20 h-screen",{"pointer-events-none":r,"bg-overlay":n==="dark","bg-white/50":n==="light","bg-highlightColor mix-blend-screen":n==="highlight",fixed:e==="screen","absolute h-full":e==="container"}),onClick:s,"aria-hidden":"true"})}function I(e,n=!1){const[r]=z(),s=ze().pathname,c=re();function o(i,a){const m=new URLSearchParams(r);i?Array.isArray(i)?i.length>0?m.set(e,i.join(",")):m.delete(e):m.set(e,i):m.delete(e),a&&Object.entries(a).forEach(([h,d])=>{d?m.set(h,d):m.delete(h)}),c(`${s}?${m.toString()}`,{replace:!0})}const l=r.get(e);return{defaultValue:n?(l==null?void 0:l.split(","))||[]:l||"",handleFilterChange:o}}function sn(){const{defaultValue:e,handleFilterChange:n}=I("color"),r=Oe.map(s=>({value:s.name.toLowerCase(),label:s.name}));return t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{variant:"uppercase",size:"small",children:"color"}),t.jsx(xe,{label:"color",options:r,value:e||"",onChange:s=>n(s),showAll:!0})]})}const rn=Object.entries(Se).map(([e,n])=>({value:e,label:`${e} ${n}`}));function an(){const{defaultValue:e,handleFilterChange:n}=I("from"),{defaultValue:r,handleFilterChange:s}=I("to"),{defaultValue:c,handleFilterChange:o}=I("currency");return t.jsxs("div",{className:"flex",children:[t.jsx(Ce,{name:"currency",placeholder:"currency",items:rn,value:c||"",onValueChange:l=>o(l)}),t.jsxs("div",{className:"flex gap-3 w-full",children:[t.jsx(oe,{type:"number",placeholder:"price from",name:"from",value:e||"",onChange:l=>n(l.target.value)}),t.jsx(oe,{type:"number",placeholder:"price to",name:"to",value:r||"",onChange:l=>s(l.target.value)})]})]})}function on(){const{defaultValue:e,handleFilterChange:n}=I("gender");return t.jsxs("div",{className:"space-y-2",children:[t.jsx(S,{variant:"uppercase",size:"small",children:"gender"}),t.jsx(xe,{label:"gender",value:e||"all",options:Le,onChange:n,showAll:!0})]})}function ln(){const{defaultValue:e,handleFilterChange:n}=I("preorder"),{defaultValue:r,handleFilterChange:s}=I("hidden"),{defaultValue:c,handleFilterChange:o}=I("sale");return t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(H,{name:"preorder",label:"preorder",checked:e==="true",onChange:l=>n(l.toString())}),t.jsx(S,{variant:"uppercase",size:"small",children:"preorder"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(H,{name:"hidden",label:"hidden",checked:r!=="false",onChange:l=>s(l?"true":"false")}),t.jsx(S,{variant:"uppercase",size:"small",children:"show hidden"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(H,{name:"sale",label:"sale",checked:c==="true",onChange:l=>o(l.toString())}),t.jsx(S,{variant:"uppercase",size:"small",children:"sale"})]})]})}const cn=Pe.map(e=>({value:String(e.value),label:e.label}));function dn(){const{defaultValue:e,handleFilterChange:n}=I("limit"),r=e||String($);return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(S,{variant:"uppercase",size:"small",className:"w-full",children:"show latest"}),t.jsx(Ce,{name:"limit",placeholder:"quantity",items:cn,value:r,onValueChange:s=>n(s)})]})}function un(e){const n=e.match(/_(\d+)(?:ta|bo)_[mf]$/);return n?n[1]:e}function mn(e){return"id"in e?String(e.id):e.name||""}function D(e){var n;return((n=e.name)==null?void 0:n.toLowerCase())||""}const fn={numeric:/^\d+(\.\d+)?$/,bottoms:/_\d+bo_[mf]$/,tailored:/_\d+ta_[mf]$/};function hn({selectedValues:e,values:n,title:r,showSeparated:s=!1,gender:c,handleFilterChange:o}){const[l,f]=w.useState(null),i=(p,_)=>fn[_].test(p),a=p=>!i(p,"numeric")&&!i(p,"bottoms")&&!i(p,"tailored"),m=n.filter(p=>a(D(p))),h=n.filter(p=>i(D(p),"numeric")),d=n.filter(p=>i(D(p),"bottoms")),u=n.filter(p=>i(D(p),"tailored")),g=s?m.length>0:!0,v=s?h.length>0:!1,b=s?d.length>0:!1,y=s?u.length>0:!1,x=async p=>{f(p),await new Promise(_=>setTimeout(_,500)),o(p),f(null)},C=p=>{const _=mn(p),O=e.includes(_),E=l===_,L=p.countMen||0,N=p.countWomen||0,F=c==="men"?L>0:c==="women"?N>0:L>0||N>0,k=un(D(p));return t.jsx(R,{onClick:()=>x(_),loading:E,loadingReverse:O,loadingType:"overlay",disabled:E||!F,className:W("block border border-transparent uppercase md:hover:border-textColor",{"border-textColor":O}),children:k},_)};if(!s)return t.jsxs("div",{className:"space-y-6",children:[r&&t.jsx(S,{variant:"uppercase",children:r}),t.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:n.map(C)})]});const T=[g,v,b,y].filter(Boolean).length>1;return t.jsxs("div",{className:W("grid",{"gap-y-7":T}),children:[g&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(S,{variant:"uppercase",children:r||"size"}),t.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:m.map(C)})]}),y&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(S,{variant:"uppercase",children:"tailored"}),t.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:u.map(C)})]}),b&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(S,{variant:"uppercase",children:"bottoms"}),t.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:d.map(C)})]}),v&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(S,{variant:"uppercase",children:"shoe size"}),t.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:h.map(C)})]})]})}function gn({filterKey:e,multiSelect:n=!1}){const{dictionary:r}=A(),{defaultValue:s,handleFilterChange:c}=I(e),o=(r==null?void 0:r.sizes)||[],l=Array.isArray(s)?s:s?s.split(","):[];l.length===0?[]:l.map(d=>o.find(u=>String(u.id)===d)).filter(Boolean);const i=l.filter(d=>o.some(u=>String(u.id)===d)),[a,m]=w.useState(i);return w.useEffect(()=>{s||m([])},[s]),{selectedValues:a,handleToggle:async d=>{let u;n?u=a.includes(d)?a.filter(v=>v!==d):[...a,d]:u=a.includes(d)?[]:[d],m(u);const g=u.length>0?u.join(","):void 0;c(g)}}}function pn(){var h;const{dictionary:e}=A(),{topCategory:n}=G(),r=(e==null?void 0:e.sizes)||[],s=e==null?void 0:e.categories,c=n!=null&&n.id?s==null?void 0:s.find(d=>d.id===n.id):void 0,o=(c==null?void 0:c.name)||"",l=o.toLowerCase().includes("shoes"),f=o.toLowerCase().includes("bottoms"),i=o.toLowerCase().includes("tailored"),a=r.filter(d=>{var y;if(!(n!=null&&n.id))return!0;const u=((y=d.name)==null?void 0:y.toLowerCase())||"",g=/^\d+(\.\d+)?$/.test(u),v=/_\d+bo_[mf]$/.test(u),b=/_\d+ta_[mf]$/.test(u);return l?g:f?v:i?b:!g&&!v&&!b});return{sizeOptions:(h=a==null?void 0:a.sort((d,u)=>(d.id??0)-(u.id??0)))==null?void 0:h.map(d=>({...d,name:d.name||""})),filteredSizes:a}}function xn({gender:e}){const{sizeOptions:n}=pn(),{selectedValues:r,handleToggle:s}=gn({filterKey:"size",multiSelect:!0});return t.jsx(hn,{selectedValues:r,handleFilterChange:s,values:n||[],showSeparated:!0,gender:e})}function vn(e,n){const r=n.sale,s=e.label?`${e.label}: `:"";return`${r?r?"sale: ":"":s}${n.name}`}function U(e,n){return Object.keys(n).find(r=>n[r]===e)||""}function Cn(){const{defaultValue:e,handleFilterChange:n}=I("sort"),{defaultValue:r}=I("order"),{defaultValue:s}=I("sale");return t.jsx("div",{className:"mr-16 space-y-2",children:Object.entries(we).flatMap(([c,o])=>o.orderFactors.map((l,f)=>{const i=e===U(c,B),a=r===U(l.factor,q),m=l.sale?s==="true":!s,h=i&&a&&m;return t.jsx(R,{onClick:()=>{h?n(void 0,{order:"",sale:""}):n(U(c,B),{order:U(l.factor,q),sale:l.sale?"true":""})},className:W("block",{underline:h}),children:vn(o,l)},`${c}-${f}`)}))})}function bn({isOpen:e,toggleModal:n}){const{gender:r}=G();return t.jsx("div",{className:"z-50 w-full",children:e&&t.jsxs("div",{className:"hidden lg:block",children:[t.jsx(ye,{cover:"screen",onClick:n,disablePointerEvents:!1}),t.jsx("div",{className:"fixed inset-y-2 right-2 z-30 w-[445px] border border-textInactiveColor bg-bgColor p-2.5 text-textColor",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(S,{variant:"uppercase",children:"filter"}),t.jsx(R,{variant:"simple",onClick:n,children:"[x]"})]}),t.jsxs("div",{className:"h-full space-y-10 overflow-y-scroll pt-6",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsx(S,{variant:"uppercase",children:"sort by"}),t.jsx(Cn,{})]}),t.jsx(ln,{}),t.jsx(dn,{}),t.jsx(on,{}),t.jsx(sn,{}),t.jsx(an,{}),t.jsx(xn,{gender:r})]}),t.jsxs("div",{className:"flex items-center justify-end gap-2 bg-bgColor",children:[t.jsx(R,{className:"w-1/2 uppercase",size:"lg",onClick:()=>{},children:"clear all"}),t.jsx(R,{className:"w-1/2 uppercase",size:"lg",onClick:()=>n(),children:"show"})]})]})})]})})}function jn({product:e,refresh:n}){var d,u,g,v,b,y,x,C,T,p,_,O,E,L;const r=(v=(g=(u=(d=e.productDisplay)==null?void 0:d.thumbnail)==null?void 0:u.media)==null?void 0:g.thumbnail)==null?void 0:v.mediaUrl,s=(x=(y=(b=e.productDisplay)==null?void 0:b.productBody)==null?void 0:y.productBodyInsert)==null?void 0:x.hidden,c=`[${e.id}] ${(p=(T=(C=e.productDisplay)==null?void 0:C.productBody)==null?void 0:T.productBodyInsert)==null?void 0:p.brand} ${(L=(E=(O=(_=e.productDisplay)==null?void 0:_.productBody)==null?void 0:O.translations)==null?void 0:E[0])==null?void 0:L.name}`,{showMessage:o}=Te(),[l,f]=w.useState(void 0),i=re();async function a(N,F){F.stopPropagation(),l===N?await se.DeleteProductByID({id:N})&&(o("PRODUCT WAS SUCCESSFULLY DELETED","success"),f(void 0),n(N)):f(N)}const m=N=>{i(`${M.product}/${N}`,{replace:!0})},h=(N,F)=>{F.stopPropagation(),confirm("Are you sure you want to copy this product?")&&i(`${M.copyProduct}/${N}`)};return t.jsxs("div",{className:"space-y-1",onClick:()=>m(e.id),children:[t.jsxs("div",{className:"relative w-full h-full group",children:[t.jsx(_e,{src:r||"",alt:"prod item",type:le(r)?"video":"image",controls:le(r)}),t.jsx(R,{onClick:N=>a(e.id,N),className:"absolute top-0 right-0 p-1 md:group-hover:block md:hidden block",children:l===e.id?t.jsx(Ie,{}):t.jsx(Ee,{})}),t.jsx(R,{size:"lg",className:"absolute bottom-0 left-0",onClick:N=>h(e.id,N),children:"copy"}),s&&t.jsx(ye,{cover:"container"})]}),t.jsx(S,{className:"w-full break-words",variant:"underLineWithColor",size:"small",children:c})]})}function yn({products:e,refresh:n}){return t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 2xl:grid-cols-6 gap-4",children:e.map(r=>t.jsx("div",{children:t.jsx(jn,{product:r,refresh:n})},r.id))})}function Nn({firstItems:e}){const[n]=z(),[r,s]=w.useState(e),[c,o]=w.useState(!1),{ref:l,inView:f}=Re(),i=w.useRef(2),a=w.useRef(!0),[m,h]=w.useState(!0),d=w.useRef(!1);w.useEffect(()=>{s(e);const x=n.has("limit");a.current=!x,h(!x),i.current=2,o(!1)},[e,n]);const u=Object.fromEntries(n.entries()),g=u.limit?Math.max(1,parseInt(u.limit,10)||$):$,v=n.has("limit"),b=async()=>{if(!a.current||c){console.log("Skipping load:",{hasMore:a.current,isLoading:c});return}o(!0);try{const x=(i.current-1)*g,T=(await se.GetProductsPaged({limit:g,offset:x,...be(u)})).products||[];(!T.length||T.length<g)&&(a.current=!1,h(!1)),i.current+=1,s(p=>[...p,...T])}catch(x){console.error("Failed to fetch more products:",x)}finally{o(!1)}};w.useEffect(()=>{if(v)return;const x=f&&!d.current;d.current=f,e.length!==0&&x&&a.current&&!c&&b()},[f,n,e.length,v]);function y(x){x&&s(r.filter(C=>C.id!==x))}return t.jsxs("div",{children:[t.jsx(yn,{products:r,refresh:y}),m&&t.jsx("div",{ref:l,className:"text-center text-xl",style:{minHeight:"100px"},children:"loading..."})]})}function On(){const[e]=z(),[n,r]=w.useState([]),[s,c]=w.useState(!1);function o(){c(!s)}const l=Object.fromEntries(e.entries()),f=re(),i={...l,sizes:l.sizes??l.size,hidden:l.hidden??"true"},a=w.useCallback(He(async d=>{const u=d.limit?Math.max(1,parseInt(d.limit,10)||$):$,g=await se.GetProductsPaged({limit:u,offset:0,...be(d)});r(g.products||[])},1e3),[]),m=e.toString();w.useEffect(()=>(a(i),()=>a.cancel()),[m,a]);const h=()=>{f(`${M.addProduct}`)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col grid gap-10 pb-20",children:[t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsx(tn,{}),t.jsx(R,{variant:"simple",className:"uppercase",onClick:o,children:"filter +"})]}),t.jsx(bn,{isOpen:s,toggleModal:o}),t.jsx(Nn,{firstItems:n})]}),t.jsx(R,{className:"fixed bottom-4 right-4 z-20",size:"lg",onClick:h,children:"create new"})]})}export{On as default};
