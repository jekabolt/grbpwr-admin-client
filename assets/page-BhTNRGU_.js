import{j as s}from"./mui--1QQx6Xz.js";import{B as R,a as z,ab as Se,ac as ie,ad as B,ae as q,R as $,T as S,c as W,S as xe,E as oe,K as we,af as Te,q as ve,d as _e,ag as le,G as Ie,b as se,ah as Ee}from"./index-DzJJ8NnH.js";import{c as Re,g as Le,a as Oe,D as A}from"./filter-Ct7KBysK.js";import{g as Pe,L as Fe,k as M,j as ke,u as re,r as T}from"./vendor-BqCw_tH9.js";import{b as Me,r as Ve,d as De,a as Ce}from"./isObjectLike-Cfdbo5Gm.js";import{S as be}from"./select-QGF26nzn.js";import{C as H}from"./checkbox-DQKxI2UC.js";var K,ce;function $e(){if(ce)return K;ce=1;var e=Me(),n=function(){return e.Date.now()};return K=n,K}var Y,de;function Ae(){if(de)return Y;de=1;var e=/\s/;function n(r){for(var t=r.length;t--&&e.test(r.charAt(t)););return t}return Y=n,Y}var X,ue;function ze(){if(ue)return X;ue=1;var e=Ae(),n=/^\s+/;function r(t){return t&&t.slice(0,e(t)+1).replace(n,"")}return X=r,X}var Z,me;function Ue(){if(me)return Z;me=1;var e=Ve(),n=De(),r="[object Symbol]";function t(c){return typeof c=="symbol"||n(c)&&e(c)==r}return Z=t,Z}var J,fe;function Be(){if(fe)return J;fe=1;var e=ze(),n=Ce(),r=Ue(),t=NaN,c=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;function a(o){if(typeof o=="number")return o;if(r(o))return t;if(n(o)){var u=typeof o.valueOf=="function"?o.valueOf():o;o=n(u)?u+"":u}if(typeof o!="string")return o===0?o:+o;o=e(o);var h=i.test(o);return h||l.test(o)?f(o.slice(2),h?2:8):c.test(o)?t:+o}return J=a,J}var Q,he;function qe(){if(he)return Q;he=1;var e=Ce(),n=$e(),r=Be(),t="Expected a function",c=Math.max,i=Math.min;function l(f,a,o){var u,h,d,m,g,v,C=0,y=!1,j=!1,p=!0;if(typeof f!="function")throw new TypeError(t);a=r(a)||0,e(o)&&(y=!!o.leading,j="maxWait"in o,d=j?c(r(o.maxWait)||0,a):d,p="trailing"in o?!!o.trailing:p);function w(b){var F=u,V=h;return u=h=void 0,C=b,m=f.apply(V,F),m}function x(b){return C=b,g=setTimeout(E,a),y?w(b):m}function _(b){var F=b-v,V=b-C,ae=a-F;return j?i(ae,d-V):ae}function O(b){var F=b-v,V=b-C;return v===void 0||F>=a||F<0||j&&V>=d}function E(){var b=n();if(O(b))return P(b);g=setTimeout(E,_(b))}function P(b){return g=void 0,p&&u?w(b):(u=h=void 0,m)}function N(){g!==void 0&&clearTimeout(g),C=0,u=v=h=g=void 0}function k(){return g===void 0?m:P(n())}function L(){var b=n(),F=O(b);if(u=arguments,h=this,v=b,F){if(g===void 0)return x(v);if(j)return clearTimeout(g),g=setTimeout(E,a),w(v)}return g===void 0&&(g=setTimeout(E,a)),m}return L.cancel=N,L.flush=k,L}return Q=l,Q}var We=qe();const Ge=Pe(We),He=e=>e.filter(r=>r.level==="top_category").map(r=>{var f;const t=e.filter(a=>a.level==="sub_category"&&a.parentId===r.id),i=((f=r.name)==null?void 0:f.toLowerCase())??"";if(t.length===0)return{id:r.id,name:i,href:`/catalog/${i.toLowerCase()}`,subCategories:[{id:r.id,name:i,href:`/catalog/${i.toLowerCase()}`}]};const l=t.map(a=>({id:a.id,name:a.name,href:`/catalog/${i.toLowerCase()}/${a.name.toLowerCase()}`}));return{id:r.id,name:i,href:`/catalog/${i.toLowerCase()}`,subCategories:l}});function ee(e,n){const r=e.find(c=>c.level==="top_category"&&c.id===n);if(!r||!r.name)return null;const t=r.name.toLowerCase();return t||r.name||null}function Ke(e,n){const r=e.find(t=>t.level==="sub_category"&&t.id===n);return!r||!r.name?null:r.name||null}function Ye(e,n){const t=He(e).find(c=>c.id===n);return(t==null?void 0:t.subCategories)||[]}function ne({href:e,children:n,disabled:r=!1,variant:t="default"}){return s.jsx(R,{asChild:!r,variant:t,className:"whitespace-nowrap uppercase hover:underline",disabled:r,children:r?s.jsx(s.Fragment,{children:n}):s.jsx(Fe,{to:e,children:n})})}function G(){var h,d;const{dictionary:e}=z(),[n]=M(),r=n.get("topCategory"),t=n.get("subCategory"),c=n.get("gender")||"",i=Se[c]??c,l=(e==null?void 0:e.categories)||[],f=r?l.find(m=>m.level==="top_category"&&String(m.id)===r)??null:null,a=t?l.find(m=>m.level==="sub_category"&&String(m.id)===t&&(f?m.parentId===f.id:!0))??null:null,o=f?((h=f.name)==null?void 0:h.toLowerCase())??"":"",u=a?((d=a.name)==null?void 0:d.toLowerCase())??"":"";return{gender:i||"",categoryName:o,subCategoryName:u,topCategory:f??void 0,subCategory:a??void 0}}function te(e,n){const r=new URLSearchParams(e);n.topCategory!==void 0&&(n.topCategory?r.set("topCategory",n.topCategory):r.delete("topCategory")),n.subCategory!==void 0&&(n.subCategory?r.set("subCategory",n.subCategory):r.delete("subCategory")),n.gender!==void 0&&(n.gender?r.set("gender",n.gender):r.delete("gender"));const t=r.toString();return t?`${$.product}?${t}`:$.product}const ge="SORT_FACTOR_CREATED_AT",pe="ORDER_FACTOR_DESC";function Xe(e){return e?B[e]?B[e]:e.startsWith("SORT_FACTOR_")&&e!=="SORT_FACTOR_UNKNOWN"?e:ge:ge}function Ze(e){return e?q[e]?q[e]:e.startsWith("ORDER_FACTOR_")&&e!=="ORDER_FACTOR_UNKNOWN"?e:pe:pe}function Je(e){return!!(e&&e.startsWith("GENDER_ENUM_")&&e!=="GENDER_ENUM_UNKNOWN"&&e!=="all")}function je({sort:e,order:n,topCategory:r,subCategory:t,type:c,gender:i,sizes:l,tag:f,color:a,from:o,to:u,sale:h,preorder:d,hidden:m,collections:g,currency:v}){const C=Xe(e),y=Ze(n),j=i&&ie[i.toLowerCase()]?ie[i.toLowerCase()]:i;return{sortFactors:[C],orderFactor:y,filterConditions:{from:o||void 0,to:u||void 0,gender:Je(j)?[j]:void 0,color:a&&a!=="all"?a:void 0,topCategoryIds:r?r.split(",").map(p=>parseInt(p)):void 0,subCategoryIds:t?t.split(",").map(p=>parseInt(p)):void 0,typeIds:c?c.split(",").map(p=>parseInt(p)):void 0,sizesIds:l?l.split(",").map(p=>parseInt(p)):void 0,byTag:f||void 0,preorder:d?d==="true":void 0,onSale:h?h==="true":void 0,collections:g?g.split(","):void 0,currency:v||void 0},showHidden:m!=="false"}}function Qe(){var l,f;const[e]=M(),{gender:n}=G(),r=e.get("gender")||void 0,{dictionary:t}=z(),c=(t==null?void 0:t.categories)||[],i=(f=(l=t==null?void 0:t.categories)==null?void 0:l.filter(a=>a.level==="top_category"&&a.name!=="objects"))==null?void 0:f.filter(a=>{if(n==="men"){const o=ee(c,a.id||0);return(o==null?void 0:o.toLowerCase())!=="dresses"}return!0}).sort((a,o)=>(a.id||0)-(o.id||0));return s.jsx("div",{className:"flex items-center gap-2",children:i==null?void 0:i.map((a,o)=>{var m;const u=ee(c,a.id||0),h=((m=a.name)==null?void 0:m.toLowerCase())||"";if(!u)return null;const d=te(e,{topCategory:String(a.id),subCategory:"",gender:r});return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ne,{href:d,disabled:ye(a,n),children:h||""}),o<i.length-1&&s.jsx(S,{children:"/"})]},a.id)})})}function en(e,n){return n==="men"?e.filter(r=>{var t;return!["swimwear_w","bralettes","heels"].includes(((t=r.name)==null?void 0:t.toLowerCase())??"")}):e.filter(r=>{var t;return((t=r.name)==null?void 0:t.toLowerCase())!=="swimwear_m"})}function ye(e,n){return e?n?n==="men"?!e.countMen:!e.countWomen:!e.countMen&&!e.countWomen:!0}function nn(){const{dictionary:e}=z(),[n]=M(),{gender:r,categoryName:t,subCategoryName:c,topCategory:i,subCategory:l}=G(),f=n.get("gender")||void 0,a=(e==null?void 0:e.categories)||[],o=Ye(a,(i==null?void 0:i.id)||0),u=en(o,r);if(!t&&!(i!=null&&i.id))return s.jsx(Qe,{});const h=i?ee(a,i.id||0):t,d=(l==null?void 0:l.id)!=null,m=te(n,{topCategory:d&&(i==null?void 0:i.id)!=null?String(i.id):"",subCategory:"",gender:f});return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ne,{href:m,children:h||t||""}),!!u.length&&s.jsx(S,{children:"/"}),u.map((g,v)=>{var w;const C=a.find(x=>x.id===g.id),y=ye(C,r),j=Ke(a,g.id),p=te(n,{topCategory:(i==null?void 0:i.id)!=null?String(i.id):"",subCategory:String(g.id),gender:f});return s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ne,{href:p,variant:c===((w=g.name)==null?void 0:w.toLowerCase())?"underline":"default",disabled:y,children:j||""}),v<u.length-1&&s.jsx(S,{children:"/"})]},g.id)})]})}function Ne({cover:e,color:n="dark",disablePointerEvents:r=!0,onClick:t}){return s.jsx("div",{className:W("inset-0 z-20 h-screen",{"pointer-events-none":r,"bg-overlay":n==="dark","bg-white/50":n==="light","bg-highlightColor mix-blend-screen":n==="highlight",fixed:e==="screen","absolute h-full":e==="container"}),onClick:t,"aria-hidden":"true"})}function I(e,n=!1){const[r]=M(),t=ke().pathname,c=re();function i(a,o){const u=new URLSearchParams(r);a?Array.isArray(a)?a.length>0?u.set(e,a.join(",")):u.delete(e):u.set(e,a):u.delete(e),o&&Object.entries(o).forEach(([h,d])=>{d?u.set(h,d):u.delete(h)}),c(`${t}?${u.toString()}`,{replace:!0})}const l=r.get(e);return{defaultValue:n?(l==null?void 0:l.split(","))||[]:l||"",handleFilterChange:i}}function tn(){const{defaultValue:e,handleFilterChange:n}=I("color"),r=Re.map(t=>({value:t.name.toLowerCase(),label:t.name}));return s.jsxs("div",{className:"space-y-2",children:[s.jsx(S,{variant:"uppercase",children:"color"}),s.jsx(xe,{label:"color",options:r,value:e||"",onChange:t=>n(t),showAll:!0})]})}const sn=Object.entries(we).map(([e,n])=>({value:e,label:`${e} ${n}`}));function rn(){const{defaultValue:e,handleFilterChange:n}=I("from"),{defaultValue:r,handleFilterChange:t}=I("to"),{defaultValue:c,handleFilterChange:i}=I("currency");return s.jsxs("div",{className:"flex",children:[s.jsx(be,{name:"currency",placeholder:"currency",items:sn,value:c||"",onValueChange:l=>i(l)}),s.jsxs("div",{className:"flex gap-3 w-full",children:[s.jsx(oe,{type:"number",placeholder:"price from",name:"from",value:e||"",onChange:l=>n(l.target.value)}),s.jsx(oe,{type:"number",placeholder:"price to",name:"to",value:r||"",onChange:l=>t(l.target.value)})]})]})}function an(){const{defaultValue:e,handleFilterChange:n}=I("gender");return s.jsxs("div",{className:"space-y-2",children:[s.jsx(S,{variant:"uppercase",children:"gender"}),s.jsx(xe,{label:"gender",value:e||"all",options:Le,onChange:n,showAll:!0})]})}function on(){const{defaultValue:e,handleFilterChange:n}=I("preorder"),{defaultValue:r,handleFilterChange:t}=I("hidden"),{defaultValue:c,handleFilterChange:i}=I("sale");return s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"preorder",label:"preorder",checked:e==="true",onChange:l=>n(l.toString())}),s.jsx(S,{variant:"uppercase",children:"preorder"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"hidden",label:"hidden",checked:r!=="false",onChange:l=>t(l?"true":"false")}),s.jsx(S,{variant:"uppercase",children:"show hidden"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(H,{name:"sale",label:"sale",checked:c==="true",onChange:l=>i(l.toString())}),s.jsx(S,{variant:"uppercase",children:"sale"})]})]})}const ln=Oe.map(e=>({value:String(e.value),label:e.label}));function cn(){const{defaultValue:e,handleFilterChange:n}=I("limit"),r=e||String(A);return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(S,{variant:"uppercase",className:"w-auto whitespace-nowrap",children:"show latest"}),s.jsx(be,{name:"limit",placeholder:"quantity",items:ln,value:r,onValueChange:t=>n(t)})]})}function dn(e){const n=e.match(/_(\d+)(?:ta|bo)_[mf]$/);return n?n[1]:e}function un(e){return"id"in e?String(e.id):e.name||""}function D(e){var n;return((n=e.name)==null?void 0:n.toLowerCase())||""}const mn={numeric:/^\d+(\.\d+)?$/,bottoms:/_\d+bo_[mf]$/,tailored:/_\d+ta_[mf]$/};function fn({selectedValues:e,values:n,title:r,showSeparated:t=!1,gender:c,handleFilterChange:i}){const[l,f]=T.useState(null),a=(x,_)=>mn[_].test(x),o=x=>!a(x,"numeric")&&!a(x,"bottoms")&&!a(x,"tailored"),u=n.filter(x=>o(D(x))),h=n.filter(x=>a(D(x),"numeric")),d=n.filter(x=>a(D(x),"bottoms")),m=n.filter(x=>a(D(x),"tailored")),g=t?u.length>0:!0,v=t?h.length>0:!1,C=t?d.length>0:!1,y=t?m.length>0:!1,j=async x=>{f(x),await new Promise(_=>setTimeout(_,500)),i(x),f(null)},p=x=>{const _=un(x),O=e.includes(_),E=l===_,P=x.countMen||0,N=x.countWomen||0,k=c==="men"?P>0:c==="women"?N>0:P>0||N>0,L=dn(D(x));return s.jsx(R,{onClick:()=>j(_),loading:E,loadingReverse:O,loadingType:"overlay",disabled:E||!k,className:W("block border border-transparent uppercase md:hover:border-textColor",{"border-textColor":O}),children:L},_)};if(!t)return s.jsxs("div",{className:"space-y-6",children:[r&&s.jsx(S,{variant:"uppercase",children:r}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:n.map(p)})]});const w=[g,v,C,y].filter(Boolean).length>1;return s.jsxs("div",{className:W("grid",{"gap-y-7":w}),children:[g&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{variant:"uppercase",children:r||"size"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:u.map(p)})]}),y&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{variant:"uppercase",children:"tailored"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:m.map(p)})]}),C&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{variant:"uppercase",children:"bottoms"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:d.map(p)})]}),v&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{variant:"uppercase",children:"shoe size"}),s.jsx("div",{className:"grid grid-cols-4 gap-x-2 gap-y-5",children:h.map(p)})]})]})}function hn({filterKey:e,multiSelect:n=!1}){const{dictionary:r}=z(),{defaultValue:t,handleFilterChange:c}=I(e),i=(r==null?void 0:r.sizes)||[],l=Array.isArray(t)?t:t?t.split(","):[];l.length===0?[]:l.map(d=>i.find(m=>String(m.id)===d)).filter(Boolean);const a=l.filter(d=>i.some(m=>String(m.id)===d)),[o,u]=T.useState(a);return T.useEffect(()=>{t||u([])},[t]),{selectedValues:o,handleToggle:async d=>{let m;n?m=o.includes(d)?o.filter(v=>v!==d):[...o,d]:m=o.includes(d)?[]:[d],u(m);const g=m.length>0?m.join(","):void 0;c(g)}}}function gn(){var h;const{dictionary:e}=z(),{topCategory:n}=G(),r=(e==null?void 0:e.sizes)||[],t=e==null?void 0:e.categories,c=n!=null&&n.id?t==null?void 0:t.find(d=>d.id===n.id):void 0,i=(c==null?void 0:c.name)||"",l=i.toLowerCase().includes("shoes"),f=i.toLowerCase().includes("bottoms"),a=i.toLowerCase().includes("tailored"),o=r.filter(d=>{var y;if(!(n!=null&&n.id))return!0;const m=((y=d.name)==null?void 0:y.toLowerCase())||"",g=/^\d+(\.\d+)?$/.test(m),v=/_\d+bo_[mf]$/.test(m),C=/_\d+ta_[mf]$/.test(m);return l?g:f?v:a?C:!g&&!v&&!C});return{sizeOptions:(h=o==null?void 0:o.sort((d,m)=>(d.id??0)-(m.id??0)))==null?void 0:h.map(d=>({...d,name:d.name||""})),filteredSizes:o}}function pn({gender:e}){const{sizeOptions:n}=gn(),{selectedValues:r,handleToggle:t}=hn({filterKey:"size",multiSelect:!0});return s.jsx(fn,{selectedValues:r,handleFilterChange:t,values:n||[],showSeparated:!0,gender:e})}function xn(e,n){const r=n.sale,t=e.label?`${e.label}: `:"";return`${r?r?"sale: ":"":t}${n.name}`}function U(e,n){return Object.keys(n).find(r=>n[r]===e)||""}function vn(){const{defaultValue:e,handleFilterChange:n}=I("sort"),{defaultValue:r}=I("order"),{defaultValue:t}=I("sale");return s.jsx("div",{className:"mr-16 space-y-2",children:Object.entries(Te).flatMap(([c,i])=>i.orderFactors.map((l,f)=>{const a=e===U(c,B),o=r===U(l.factor,q),u=l.sale?t==="true":!t,h=a&&o&&u;return s.jsx(R,{onClick:()=>{h?n(void 0,{order:"",sale:""}):n(U(c,B),{order:U(l.factor,q),sale:l.sale?"true":""})},className:W("block",{underline:h}),children:xn(i,l)},`${c}-${f}`)}))})}function Cn({isOpen:e,toggleModal:n}){const{gender:r}=G(),[t,c]=M(),i=()=>{c(new URLSearchParams)};return s.jsx("div",{className:"z-50 w-full",children:e&&s.jsxs("div",{className:"hidden lg:block",children:[s.jsx(Ne,{cover:"screen",onClick:n,disablePointerEvents:!1}),s.jsx("div",{className:"fixed inset-y-2 right-2 z-30 w-[445px] border border-textInactiveColor bg-bgColor p-2.5 text-textColor",children:s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(S,{variant:"uppercase",children:"filter"}),s.jsx(R,{onClick:n,children:"[x]"})]}),s.jsxs("div",{className:"h-full space-y-10 overflow-y-scroll py-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{variant:"uppercase",children:"sort by"}),s.jsx(vn,{})]}),s.jsx(on,{}),s.jsx(cn,{}),s.jsx(an,{}),s.jsx(tn,{}),s.jsx(rn,{}),s.jsx(pn,{gender:r})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 bg-bgColor",children:[s.jsx(R,{className:"w-1/2 uppercase",variant:"main",size:"lg",onClick:i,children:"clear all"}),s.jsx(R,{className:"w-1/2 uppercase",variant:"main",size:"lg",onClick:()=>n(),children:"show"})]})]})})]})})}function bn({product:e,refresh:n}){var d,m,g,v,C,y,j,p,w,x,_,O,E,P;const r=(v=(g=(m=(d=e.productDisplay)==null?void 0:d.thumbnail)==null?void 0:m.media)==null?void 0:g.thumbnail)==null?void 0:v.mediaUrl,t=(j=(y=(C=e.productDisplay)==null?void 0:C.productBody)==null?void 0:y.productBodyInsert)==null?void 0:j.hidden,c=`[${e.id}] ${(x=(w=(p=e.productDisplay)==null?void 0:p.productBody)==null?void 0:w.productBodyInsert)==null?void 0:x.brand} ${(P=(E=(O=(_=e.productDisplay)==null?void 0:_.productBody)==null?void 0:O.translations)==null?void 0:E[0])==null?void 0:P.name}`,{showMessage:i}=ve(),[l,f]=T.useState(void 0),a=re();async function o(N,k){if(k.stopPropagation(),l===N)try{await se.DeleteProductByID({id:N}),i("PRODUCT WAS SUCCESSFULLY DELETED","success"),f(void 0),n(N)}catch(L){const b=L instanceof Error?L.message:"Failed to delete product";i(b,"error")}else f(N)}const u=N=>{a(`${$.product}/${N}`,{replace:!0})},h=(N,k)=>{k.stopPropagation(),confirm("Are you sure you want to copy this product?")&&a(`${$.copyProduct}/${N}`)};return s.jsxs("div",{className:"space-y-1",onClick:()=>u(e.id),children:[s.jsxs("div",{className:"relative w-full h-full group",children:[s.jsx(_e,{src:r||"",alt:"prod item",type:le(r)?"video":"image",controls:le(r)}),s.jsx(R,{onClick:N=>o(e.id,N),className:"absolute top-0 right-0 p-1 md:group-hover:block md:hidden block",children:l===e.id?s.jsx(Ie,{}):"[x]"}),s.jsx(R,{size:"lg",className:"absolute bottom-0 left-0 z-30",variant:"main",onClick:N=>h(e.id,N),children:"copy"}),t&&s.jsx(Ne,{cover:"container"})]}),s.jsx(S,{className:"w-full break-words",variant:"underLineWithColor",children:c})]})}function jn({products:e,refresh:n}){return s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 2xl:grid-cols-6 gap-4",children:e.map(r=>s.jsx("div",{children:s.jsx(bn,{product:r,refresh:n})},r.id))})}function yn({firstItems:e}){const[n]=M(),[r,t]=T.useState(e),[c,i]=T.useState(!1),{showMessage:l}=ve(),{ref:f,inView:a}=Ee(),o=T.useRef(2),u=T.useRef(!0),[h,d]=T.useState(!0),m=T.useRef(!1);T.useEffect(()=>{t(e);const p=n.has("limit");u.current=!p,d(!p),o.current=2,i(!1)},[e,n]);const g=Object.fromEntries(n.entries()),v=g.limit?Math.max(1,parseInt(g.limit,10)||A):A,C=n.has("limit"),y=async()=>{if(!u.current||c){console.log("Skipping load:",{hasMore:u.current,isLoading:c});return}i(!0);try{const p=(o.current-1)*v,x=(await se.GetProductsPaged({limit:v,offset:p,...je(g)})).products||[];(!x.length||x.length<v)&&(u.current=!1,d(!1)),o.current+=1,t(_=>[..._,...x])}catch(p){const w=p instanceof Error?p.message:"Failed to fetch more products";l(w,"error")}finally{i(!1)}};T.useEffect(()=>{if(C)return;const p=a&&!m.current;m.current=a,e.length!==0&&p&&u.current&&!c&&y()},[a,n,e.length,C]);function j(p){p&&t(r.filter(w=>w.id!==p))}return s.jsxs("div",{children:[s.jsx(jn,{products:r,refresh:j}),h&&s.jsx("div",{ref:f,className:"text-center text-xl",style:{minHeight:"100px"},children:"loading..."})]})}function Rn(){const[e]=M(),[n,r]=T.useState([]),[t,c]=T.useState(!1);function i(){c(!t)}const l=Object.fromEntries(e.entries()),f=re(),a={...l,sizes:l.sizes??l.size,hidden:l.hidden??"true"},o=T.useCallback(Ge(async d=>{const m=d.limit?Math.max(1,parseInt(d.limit,10)||A):A,g=await se.GetProductsPaged({limit:m,offset:0,...je(d)});r(g.products||[])},1e3),[]),u=e.toString();T.useEffect(()=>(o(a),()=>o.cancel()),[u,o]);const h=()=>{f(`${$.addProduct}`)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col grid gap-10 pb-20",children:[s.jsxs("div",{className:"flex items-end justify-between",children:[s.jsx(nn,{}),s.jsx(R,{className:"uppercase",onClick:i,children:"filter +"})]}),s.jsx(Cn,{isOpen:t,toggleModal:i}),s.jsx(yn,{firstItems:n})]}),s.jsx(R,{variant:"main",className:"fixed bottom-4 right-4 z-20",size:"lg",onClick:h,children:"create new"})]})}export{Rn as default};
