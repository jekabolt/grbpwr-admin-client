import{j as e}from"./mui-8bJoa1Af.js";import{u as D,r as o}from"./vendor-DljJgkTU.js";import{a as T,E as I,x as w,c as v,B as S,T as m,D as N,S as _,y as A,H as F,J as k,b as P}from"./index-DJFsu7OP.js";import{s as M}from"./filter-B8x8g7tl.js";function L({orders:a,orderFactor:i,status:d,orderId:u,isLoading:s,onToggleSort:n,onStatusChange:c,onOrderIdChange:x}){const{dictionary:h}=T(),f=D(),C=r=>{f(`${F.orders}/${r.uuid}`)},p=o.useMemo(()=>[{label:"Order ID",accessor:r=>r.id},{label:"Order Status",accessor:r=>I(h,r.orderStatusId)},{label:"Placed",accessor:r=>w(r.placed)},{label:"Total",accessor:r=>{var t;return`${(t=r.totalPrice)==null?void 0:t.value} ${r.currency}`}}],[h]);return e.jsx("div",{className:"w-full flex flex-col gap-4",children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full border-collapse border-2 border-textColor min-w-max",children:[e.jsx("thead",{className:"bg-textInactiveColor h-10 overflow-x-scroll",children:e.jsx("tr",{className:"border-b border-textColor",children:p.map(r=>e.jsx("th",{className:v("text-center h-10 min-w-26 border border-r border-textColor px-2",{"sticky left-0 bg-textInactiveColor z-10":r.label==="Order ID"}),children:r.label==="Order ID"?e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs(S,{onClick:n,disabled:s,className:"flex items-center justify-center gap-1 whitespace-nowrap hover:opacity-70 transition-opacity",children:[e.jsx("div",{className:"flex items-center gap-1 leading-none",children:["↑","↓"].map((t,b)=>e.jsx(m,{className:v("text-textColor",{"opacity-50":b===0&&i==="ORDER_FACTOR_DESC"||b===1&&i==="ORDER_FACTOR_ASC"}),children:t},t))}),e.jsx(m,{variant:"uppercase",children:r.label})]}),e.jsx(N,{name:"orderId",type:"number",placeholder:"order id",value:u,onChange:t=>x(t.target.value),disabled:s,className:"w-16 bg-textInactiveColor [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none placeholder:text-textColor"})]}):r.label==="Order Status"?e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(m,{className:"",variant:"uppercase",children:r.label}),e.jsx(_,{label:"",options:[{value:"all",label:"all"},...M],onChange:t=>c(t==="all"?"":t),value:d||"all",compact:!0,disabled:s})]}):e.jsx(m,{variant:"uppercase",children:r.label})},r.label))})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:p.length,className:"text-center py-8",children:e.jsx(m,{variant:"uppercase",children:"no orders found"})})}):a.map(r=>e.jsx("tr",{className:"group border-b border-text last:border-b-0 h-10 hover:bg-highlightColor/20 cursor-pointer transition-colors",onClick:()=>C(r),children:p.map(t=>{const b=t.accessor(r),j=t.label==="Order Status"?A(String(b)):"";return e.jsx("td",{className:v("border border-r border-textColor text-center px-2",j,{"sticky left-0 bg-bgColor group-hover:bg-highlightColor/20 z-10":t.label==="Order ID"}),children:e.jsx(m,{children:b})},t.label)})},r.id))})]})})})}const O={all:["order"],orders:a=>[...O.all,"orders",a],order:a=>[...O.orders(),a]};function $(a=50,i="ORDER_FACTOR_DESC",d,u,s){return k({queryKey:[...O.orders(i),d,u,s],queryFn:async({pageParam:n})=>{var x;const c=await P.ListOrders({limit:a,offset:n,orderFactor:i,status:u,paymentMethod:void 0,email:d,orderId:s?Number(s):void 0});return{orders:c.orders||[],nextOffset:((x=c.orders)==null?void 0:x.length)===a?n+a:void 0}},getNextPageParam:n=>n.nextOffset,initialPageParam:0,staleTime:300*1e3})}function U(){const[a,i]=o.useState("ORDER_FACTOR_DESC"),[d,u]=o.useState(""),[s,n]=o.useState(""),[c,x]=o.useState(""),[h,f]=o.useState(""),[C,p]=o.useState("");o.useEffect(()=>{const l=setTimeout(()=>{f(c)},500);return()=>clearTimeout(l)},[c]),o.useEffect(()=>{const l=setTimeout(()=>{p(s)},500);return()=>clearTimeout(l)},[s]);const{data:r,isLoading:t,isError:b,fetchNextPage:j,hasNextPage:y,isFetchingNextPage:g}=$(50,a,h||void 0,d||void 0,C||void 0),R=(r==null?void 0:r.pages.flatMap(l=>l.orders))||[],E=()=>{i(l=>l==="ORDER_FACTOR_ASC"?"ORDER_FACTOR_DESC":"ORDER_FACTOR_ASC")};return e.jsxs("div",{className:"flex flex-col gap-4 pb-16",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(N,{name:"email",type:"text",placeholder:"enter email",value:c,onChange:l=>x(l.target.value),disabled:t||g,className:"w-64"})}),e.jsx(L,{orders:R,orderFactor:a,onToggleSort:E,status:d,onStatusChange:u,orderId:s,onOrderIdChange:n,isLoading:t||g}),y&&e.jsx("div",{className:"flex justify-center",children:e.jsx(S,{variant:"main",size:"lg",onClick:()=>j(),disabled:g,children:g?"Loading...":"Load More"})})]})}export{U as OrdersCatalog};
